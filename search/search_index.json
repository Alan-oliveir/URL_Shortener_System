{"config":{"lang":["pt"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"URL Shortener System Documentation","text":"<p>Bem-vindo \u00e0 documenta\u00e7\u00e3o completa do URL Shortener System - uma solu\u00e7\u00e3o serverless completa para encurtamento de URLs desenvolvida com Java e AWS.</p>"},{"location":"#o-que-e-este-sistema","title":"O que \u00e9 este sistema?","text":"<p>Um encurtador de URLs moderno constru\u00eddo com arquitetura de microservi\u00e7os serverless, demonstrando as melhores pr\u00e1ticas de desenvolvimento cloud-native.</p> <pre><code>graph TD\n    A[Cliente] --&gt; B[API Gateway]\n    B --&gt; C[Create URL Lambda]\n    B --&gt; D[Redirect Lambda]\n    C --&gt; E[Amazon S3]\n    D --&gt; E\n    D --&gt; F[HTTP Redirect]</code></pre>"},{"location":"#quick-start","title":"Quick Start","text":"Criar URL <pre><code>curl -X POST https://api.exemplo.com/create \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"originalUrl\": \"https://exemplo.com/artigo-longo\",\n    \"expirationTime\": \"1672531200\"\n  }'\n</code></pre> Usar URL <pre><code>curl -I https://api.exemplo.com/a1b2c3d4\n# \u2192 302 Redirect para URL original\n</code></pre>"},{"location":"#arquitetura","title":"Arquitetura","text":"Componente Tecnologia Responsabilidade Compute AWS Lambda Processamento serverless Storage Amazon S3 Armazenamento de dados API API Gateway Roteamento de requisi\u00e7\u00f5es Language Java 17 L\u00f3gica de neg\u00f3cio"},{"location":"#navegacao-rapida","title":"Navega\u00e7\u00e3o R\u00e1pida","text":""},{"location":"#getting-started","title":"Getting Started","text":"<p>Configure e execute o sistema em minutos</p> <p>Quick Start</p>"},{"location":"#deployment","title":"Deployment","text":"<p>Deploy completo na AWS com todas as configura\u00e7\u00f5es</p> <p>AWS Setup</p>"},{"location":"#api-reference","title":"API Reference","text":"<p>Documenta\u00e7\u00e3o completa das APIs dispon\u00edveis</p> <p>APIs</p>"},{"location":"#monitoring","title":"Monitoring","text":"<p>Logs, m\u00e9tricas e troubleshooting</p> <p>Monitoring</p>"},{"location":"#destaques-tecnicos","title":"Destaques T\u00e9cnicos","text":"<p>Arquitetura Serverless</p> <p>Zero infraestrutura para gerenciar, escalabilidade autom\u00e1tica e pay-per-use.</p> <p>Microservi\u00e7os</p> <p>Dois servi\u00e7os independentes: cria\u00e7\u00e3o e redirecionamento de URLs.</p> <p>Tecnologias Modernas</p> <p>Java 17, AWS Lambda, S3, API Gateway, Maven e Jackson.</p>"},{"location":"#contribuindo","title":"Contribuindo","text":"<p>Este projeto foi desenvolvido durante evento de programa\u00e7\u00e3o e est\u00e1 dispon\u00edvel para fins educacionais e demonstra\u00e7\u00e3o de habilidades t\u00e9cnicas.</p> <p>Pr\u00f3ximos passos: Comece com o Getting Started para executar o sistema localmente.</p>"},{"location":"architecture/","title":"System Architecture","text":"<p>Esta p\u00e1gina detalha a arquitetura completa do URL Shortener System, incluindo componentes, fluxos de dados e decis\u00f5es de design.</p>"},{"location":"architecture/#visao-geral-da-arquitetura","title":"Vis\u00e3o Geral da Arquitetura","text":"<p>O sistema foi projetado seguindo os princ\u00edpios de arquitetura serverless e microservi\u00e7os, proporcionando alta escalabilidade, baixo custo operacional e facilidade de manuten\u00e7\u00e3o.</p> <pre><code>graph TB\n    subgraph \"Cliente\"\n        C[Browser/App]\n    end\n\n    subgraph \"AWS Cloud\"\n        subgraph \"API Layer\"\n            AG[API Gateway]\n        end\n\n        subgraph \"Compute Layer\"\n            L1[Create URL Lambda]\n            L2[Redirect URL Lambda]\n        end\n\n        subgraph \"Storage Layer\"\n            S3[Amazon S3 Bucket]\n        end\n\n        subgraph \"Security Layer\"\n            IAM[IAM Roles &amp; Policies]\n        end\n    end\n\n    C --&gt;|HTTP Requests| AG\n    AG --&gt;|POST /create| L1\n    AG --&gt;|GET /code| L2\n    L1 --&gt;|Store URL Data| S3\n    L2 --&gt;|Retrieve URL Data| S3\n    L1 -.-&gt;|Permissions| IAM\n    L2 -.-&gt;|Permissions| IAM</code></pre>"},{"location":"architecture/#principios-de-design","title":"Princ\u00edpios de Design","text":""},{"location":"architecture/#1-serverless-first","title":"1. Serverless First","text":"<ul> <li>Sem servidores para gerenciar</li> <li>Escalabilidade autom\u00e1tica</li> <li>Modelo pay-per-use</li> </ul>"},{"location":"architecture/#2-microservicos","title":"2. Microservi\u00e7os","text":"<ul> <li>Separa\u00e7\u00e3o de responsabilidades</li> <li>Deploy independente</li> <li>Resili\u00eancia isolada</li> </ul>"},{"location":"architecture/#3-event-driven","title":"3. Event-Driven","text":"<ul> <li>Processamento ass\u00edncrono</li> <li>Baixo acoplamento</li> <li>Alta disponibilidade</li> </ul>"},{"location":"architecture/#4-stateless","title":"4. Stateless","text":"<ul> <li>Sem estado entre requisi\u00e7\u00f5es</li> <li>Escalabilidade horizontal</li> <li>Recupera\u00e7\u00e3o r\u00e1pida</li> </ul>"},{"location":"architecture/#componentes-detalhados","title":"Componentes Detalhados","text":""},{"location":"architecture/#api-gateway","title":"API Gateway","text":"<p>Responsabilidade: Ponto de entrada \u00fanico para todas as requisi\u00e7\u00f5es</p> <pre><code>Configuration:\n  Type: REST API\n  Endpoints:\n    - POST /create     \u2192 Create URL Lambda\n    - GET /{code}      \u2192 Redirect URL Lambda\n  Features:\n    - Rate limiting\n    - Request validation\n    - CORS support\n    - API keys (opcional)\n</code></pre> <p>Benef\u00edcios:  </p> <ul> <li>Roteamento centralizado  </li> <li>Throttling autom\u00e1tico  </li> <li>Logs de requisi\u00e7\u00f5es  </li> <li>Transforma\u00e7\u00e3o de dados  </li> </ul>"},{"location":"architecture/#create-url-lambda","title":"Create URL Lambda","text":"<p>Responsabilidade: Processar cria\u00e7\u00e3o de URLs encurtadas</p> <pre><code>flowchart TD\n    A[Receber Requisi\u00e7\u00e3o] --&gt; B{Validar JSON}\n    B --&gt;|V\u00e1lido| C[Extrair originalUrl e expirationTime]\n    B --&gt;|Inv\u00e1lido| D[Retornar Erro 400]\n    C --&gt; E[Gerar UUID de 8 caracteres]\n    E --&gt; F[Criar objeto UrlData]\n    F --&gt; G[Serializar para JSON]\n    G --&gt; H[Salvar no S3]\n    H --&gt;|Sucesso| I[Retornar c\u00f3digo]\n    H --&gt;|Erro| J[Retornar Erro 500]</code></pre> <p>Caracter\u00edsticas T\u00e9cnicas:  </p> <ul> <li>Runtime: Java 17  </li> <li>Memory: 512 MB (recomendado)  </li> <li>Timeout: 30 segundos  </li> <li>Handler: <code>com.rocketseat.createUrlShortner.Main::handleRequest</code> </li> </ul>"},{"location":"architecture/#redirect-url-lambda","title":"Redirect URL Lambda","text":"<p>Responsabilidade: Resolver c\u00f3digos e redirecionar usu\u00e1rios</p> <pre><code>flowchart TD\n    A[Receber Requisi\u00e7\u00e3o] --&gt; B{C\u00f3digo v\u00e1lido?}\n    B --&gt;|N\u00e3o| C[Retornar Erro 400]\n    B --&gt;|Sim| D[Buscar no S3]\n    D --&gt;|N\u00e3o encontrado| E[Retornar Erro 404]\n    D --&gt;|Encontrado| F[Deserializar JSON]\n    F --&gt; G{URL expirada?}\n    G --&gt;|Sim| H[Retornar 410 Gone]\n    G --&gt;|N\u00e3o| I[Retornar 302 Redirect]</code></pre> <p>Caracter\u00edsticas T\u00e9cnicas:  </p> <ul> <li>Runtime: Java 17  </li> <li>Memory: 256 MB (suficiente)  </li> <li>Timeout: 15 segundos  </li> <li>Handler: <code>com.rocketseat.redirectUrlShortner.Main::handleRequest</code> </li> </ul>"},{"location":"architecture/#amazon-s3","title":"Amazon S3","text":"<p>Responsabilidade: Armazenamento persistente de dados das URLs</p> <pre><code>Bucket Configuration:\n  Name: aws-url-shortner-app\n  Region: us-east-1 (recomendado)\n  Versioning: Disabled\n  Encryption: AES-256 (server-side)\n\nObject Structure:\n  Key: \"{8-char-code}.json\"\n  Content: |\n    {\n      \"originalUrl\": \"https://exemplo.com/url-longa\",\n      \"expirationTime\": 1672531200\n    }\n</code></pre> <p>Benef\u00edcios:  </p> <ul> <li>Durabilidade de 99.999999999%  </li> <li>Escalabilidade ilimitada  </li> <li>Baixo custo por GB  </li> <li>Integra\u00e7\u00e3o nativa com Lambda  </li> </ul>"},{"location":"architecture/#fluxos-de-dados","title":"Fluxos de Dados","text":""},{"location":"architecture/#fluxo-de-criacao-de-url","title":"Fluxo de Cria\u00e7\u00e3o de URL","text":"<pre><code>sequenceDiagram\n    participant C as Cliente\n    participant AG as API Gateway\n    participant L1 as Create Lambda\n    participant S3 as Amazon S3\n\n    C-&gt;&gt;AG: POST /create\n    Note over C,AG: originalUrl + expirationTime\n\n    AG-&gt;&gt;L1: Invoke Lambda\n    L1-&gt;&gt;L1: Parse JSON\n    L1-&gt;&gt;L1: Generate UUID code\n    L1-&gt;&gt;L1: Create UrlData object\n\n    L1-&gt;&gt;S3: PutObject\n    Note over L1,S3: Key: code.json\n\n    S3--&gt;&gt;L1: Success\n    L1--&gt;&gt;AG: Return code\n    AG--&gt;&gt;C: 200 OK + response</code></pre>"},{"location":"architecture/#fluxo-de-redirecionamento","title":"Fluxo de Redirecionamento","text":"<pre><code>sequenceDiagram\n    participant C as Cliente\n    participant AG as API Gateway\n    participant L2 as Redirect Lambda\n    participant S3 as Amazon S3\n\n    C-&gt;&gt;AG: GET /a1b2c3d4\n    AG-&gt;&gt;L2: Invoke Lambda\n    L2-&gt;&gt;L2: Extract code from path\n\n    L2-&gt;&gt;S3: GetObject\n    Note over L2,S3: Key: a1b2c3d4.json\n\n    alt Object exists\n        S3--&gt;&gt;L2: UrlData JSON\n        L2-&gt;&gt;L2: Parse JSON\n        L2-&gt;&gt;L2: Check expiration\n\n        alt Not expired\n            L2--&gt;&gt;AG: 302 + Location header\n            AG--&gt;&gt;C: Redirect to original URL\n        else Expired\n            L2--&gt;&gt;AG: 410 Gone\n            AG--&gt;&gt;C: URL expired message\n        end\n    else Object not found\n        S3--&gt;&gt;L2: NoSuchKey error\n        L2--&gt;&gt;AG: 500 Error\n        AG--&gt;&gt;C: Internal server error\n    end</code></pre>"},{"location":"architecture/#seguranca-e-permissions","title":"Seguran\u00e7a e Permissions","text":""},{"location":"architecture/#iam-roles-e-policies","title":"IAM Roles e Policies","text":""},{"location":"architecture/#create-url-lambda-role","title":"Create URL Lambda Role","text":"<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:PutObject\",\n        \"s3:PutObjectAcl\"\n      ],\n      \"Resource\": \"arn:aws:s3:::aws-url-shortner-app/*\"\n    }\n  ]\n}\n</code></pre>"},{"location":"architecture/#redirect-url-lambda-role","title":"Redirect URL Lambda Role","text":"<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\"\n      ],\n      \"Resource\": \"arn:aws:s3:::aws-url-shortner-app/*\"\n    }\n  ]\n}\n</code></pre>"},{"location":"architecture/#principio-do-menor-privilegio","title":"Princ\u00edpio do Menor Privil\u00e9gio","text":"<ul> <li>Cada Lambda tem apenas as permiss\u00f5es m\u00ednimas necess\u00e1rias</li> <li>Acesso restrito apenas ao bucket espec\u00edfico</li> <li>Logs separados por fun\u00e7\u00e3o</li> </ul>"},{"location":"architecture/#performance-e-escalabilidade","title":"Performance e Escalabilidade","text":""},{"location":"architecture/#caracteristicas-de-performance","title":"Caracter\u00edsticas de Performance","text":"Componente Lat\u00eancia T\u00edpica Throughput Escalabilidade API Gateway &lt; 10ms 10,000 RPS Autom\u00e1tica Create Lambda 100-500ms 1,000 concurrent Autom\u00e1tica Redirect Lambda 50-200ms 1,000 concurrent Autom\u00e1tica S3 &lt; 100ms Unlimited Autom\u00e1tica"},{"location":"architecture/#otimizacoes-implementadas","title":"Otimiza\u00e7\u00f5es Implementadas","text":"<p>Cold Start Mitigation: </p> <ul> <li>Uso de Lombok para reduzir reflection  </li> <li>Jackson ObjectMapper reutilizado  </li> <li>Depend\u00eancias m\u00ednimas  </li> </ul> <p>Memory Optimization:</p> <ul> <li>Create Lambda: 512MB (processamento JSON)  </li> <li>Redirect Lambda: 256MB (opera\u00e7\u00e3o mais simples)  </li> </ul> <p>S3 Performance: </p> <ul> <li>Naming strategy com UUID evita hot-spotting  </li> <li>Objetos pequenos (&lt; 1KB) para baixa lat\u00eancia  </li> </ul>"},{"location":"architecture/#monitoramento-e-observabilidade","title":"Monitoramento e Observabilidade","text":""},{"location":"architecture/#cloudwatch-metrics-automaticas","title":"CloudWatch Metrics (Autom\u00e1ticas)","text":"<ul> <li>Duration: Tempo de execu\u00e7\u00e3o das Lambdas</li> <li>Invocations: N\u00famero de execu\u00e7\u00f5es</li> <li>Errors: Contagem de erros</li> <li>Throttles: Requisi\u00e7\u00f5es limitadas</li> </ul>"},{"location":"architecture/#logs-estruturados","title":"Logs Estruturados","text":"<pre><code>// Exemplo de log estruturado\ncontext.getLogger().log(String.format(\n    \"URL created: code=%s, originalUrl=%s, expirationTime=%d\",\n    shortUrlCode, originalUrl, expirationTimeInSeconds\n));\n</code></pre>"},{"location":"architecture/#alertas-recomendados","title":"Alertas Recomendados","text":"<ul> <li>Error rate &gt; 5%</li> <li>Duration &gt; 10 segundos</li> <li>Throttles &gt; 0</li> </ul>"},{"location":"architecture/#beneficios-da-arquitetura","title":"Benef\u00edcios da Arquitetura","text":""},{"location":"architecture/#escalabilidade","title":"Escalabilidade","text":"<ul> <li>Autom\u00e1tica: Sem configura\u00e7\u00e3o manual</li> <li>El\u00e1stica: Escala para zero quando n\u00e3o h\u00e1 tr\u00e1fego</li> <li>Global: Pode ser replicada em m\u00faltiplas regi\u00f5es</li> </ul>"},{"location":"architecture/#confiabilidade","title":"Confiabilidade","text":"<ul> <li>Sem single point of failure</li> <li>Retry autom\u00e1tico em falhas transit\u00f3rias</li> <li>Durabilidade garantida pelo S3</li> </ul>"},{"location":"architecture/#custo-efetividade","title":"Custo-Efetividade","text":"<ul> <li>Pay-per-use: Paga apenas pelo que consome</li> <li>Sem infraestrutura ociosa</li> <li>Custo previs\u00edvel baseado no volume</li> </ul>"},{"location":"architecture/#developer-experience","title":"Developer Experience","text":"<ul> <li>Deployment simples: JAR upload</li> <li>Logs centralizados: CloudWatch</li> <li>Versionamento: Lambda versions e aliases</li> </ul>"},{"location":"architecture/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<p>Esta arquitetura base permite evolu\u00e7\u00f5es como:</p> <ul> <li>Cache Layer: Redis/ElastiCache para URLs frequentes</li> <li>Analytics: DynamoDB para m\u00e9tricas de uso</li> <li>CDN: CloudFront para distribui\u00e7\u00e3o global</li> <li>Custom Domains: Route 53 para dom\u00ednios personalizados</li> <li>Batch Processing: Limpeza autom\u00e1tica de URLs expiradas</li> </ul> <p>A arquitetura apresentada demonstra como construir sistemas modernos, escal\u00e1veis e cost-effective utilizando os princ\u00edpios cloud-native e as melhores pr\u00e1ticas de desenvolvimento serverless.</p>"},{"location":"getting-started/","title":"Getting Started","text":"<p>Este guia vai te ajudar a configurar e executar o URL Shortener System do zero. Em poucos minutos voc\u00ea ter\u00e1 um sistema completo de encurtamento de URLs funcionando na AWS.</p>"},{"location":"getting-started/#pre-requisitos","title":"Pr\u00e9-requisitos","text":"<p>Antes de come\u00e7ar, certifique-se de ter os seguintes requisitos:</p>"},{"location":"getting-started/#ferramentas-necessarias","title":"Ferramentas Necess\u00e1rias","text":"<ul> <li>Java 17+ - Download aqui</li> <li>Maven 3.6+ - Instala\u00e7\u00e3o</li> <li>AWS CLI - Configura\u00e7\u00e3o</li> <li>Git - Para clonar os reposit\u00f3rios</li> </ul>"},{"location":"getting-started/#conta-aws","title":"Conta AWS","text":"<p>Importante</p> <p>Voc\u00ea precisar\u00e1 de uma conta AWS ativa. Alguns servi\u00e7os podem gerar custos m\u00ednimos.</p> Verificar JavaVerificar MavenVerificar AWS CLI <pre><code>java --version\n# Deve retornar Java 17 ou superior\n</code></pre> <pre><code>mvn --version\n# Deve retornar Maven 3.6 ou superior\n</code></pre> <pre><code>aws --version\n# Configure com: aws configure\n</code></pre>"},{"location":"getting-started/#configuracao-rapida","title":"Configura\u00e7\u00e3o R\u00e1pida","text":""},{"location":"getting-started/#1-clonar-o-projeto","title":"1. Clonar o Projeto","text":"<pre><code># Clonar reposit\u00f3rio principal\ngit clone https://github.com/seu-usuario/url-shortener-system.git\ncd url-shortener-system\n\n# Inicializar submodules\ngit submodule init\ngit submodule update\n</code></pre>"},{"location":"getting-started/#2-configurar-aws","title":"2. Configurar AWS","text":""},{"location":"getting-started/#criar-bucket-s3","title":"Criar Bucket S3","text":"<pre><code># Criar bucket (nome deve ser \u00fanico globalmente)\naws s3 mb s3://aws-url-shortner-app-SEU-NOME\n\n# Verificar se foi criado\naws s3 ls | grep url-shortner\n</code></pre>"},{"location":"getting-started/#configurar-permissoes-iam","title":"Configurar Permiss\u00f5es IAM","text":"<p>Crie uma role IAM com as seguintes permiss\u00f5es:</p> lambda-s3-policy.json<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:PutObject\"\n      ],\n      \"Resource\": \"arn:aws:s3:::aws-url-shortner-app-SEU-NOME/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:*\"\n    }\n  ]\n}\n</code></pre>"},{"location":"getting-started/#3-build-dos-microservicos","title":"3. Build dos Microservi\u00e7os","text":"Create URL ServiceRedirect Service <pre><code>cd create-url-service\nmvn clean compile\nmvn package\n\n# JAR ser\u00e1 gerado em target/CreateUrlLambda-1.0-SNAPSHOT.jar\n</code></pre> <pre><code>cd redirect-url-service\nmvn clean compile\nmvn package\n\n# JAR ser\u00e1 gerado em target/RedirectUrlShortner-1.0-SNAPSHOT.jar\n</code></pre>"},{"location":"getting-started/#deploy-na-aws","title":"Deploy na AWS","text":""},{"location":"getting-started/#1-deploy-das-funcoes-lambda","title":"1. Deploy das Fun\u00e7\u00f5es Lambda","text":""},{"location":"getting-started/#create-url-lambda","title":"Create URL Lambda","text":"<ol> <li> <p>Acessar AWS Lambda Console</p> </li> <li> <p>Criar Nova Fun\u00e7\u00e3o</p> <ul> <li>Nome: <code>url-shortener-create</code></li> <li>Runtime: <code>Java 17</code></li> <li>Arquitetura: <code>x86_64</code></li> </ul> </li> <li> <p>Upload do C\u00f3digo</p> <ul> <li>Fazer upload do JAR: <code>CreateUrlLambda-1.0-SNAPSHOT.jar</code></li> <li>Handler: <code>com.rocketseat.createUrlShortner.Main::handleRequest</code></li> </ul> </li> <li> <p>Configura\u00e7\u00f5es</p> <ul> <li>Timeout: <code>30 segundos</code></li> <li>Mem\u00f3ria: <code>256 MB</code></li> <li>Vari\u00e1veis de ambiente (se necess\u00e1rio)</li> </ul> </li> </ol>"},{"location":"getting-started/#redirect-url-lambda","title":"Redirect URL Lambda","text":"<ol> <li> <p>Criar Nova Fun\u00e7\u00e3o</p> <ul> <li>Nome: <code>url-shortener-redirect</code></li> <li>Runtime: <code>Java 17</code></li> <li>Arquitetura: <code>x86_64</code></li> </ul> </li> <li> <p>Upload do C\u00f3digo</p> <ul> <li>Fazer upload do JAR: <code>RedirectUrlShortner-1.0-SNAPSHOT.jar</code></li> <li>Handler: <code>com.rocketseat.redirectUrlShortner.Main::handleRequest</code> </li> </ul> </li> </ol>"},{"location":"getting-started/#2-configurar-api-gateway","title":"2. Configurar API Gateway","text":""},{"location":"getting-started/#criar-api-rest","title":"Criar API REST","text":"<pre><code># Usando AWS CLI\naws apigateway create-rest-api \\\n    --name url-shortener-api \\\n    --description \"API para sistema de encurtamento de URLs\"\n</code></pre>"},{"location":"getting-started/#configurar-rotas","title":"Configurar Rotas","text":"Rota CREATERota REDIRECT <ul> <li>M\u00e9todo: <code>POST</code></li> <li>Path: <code>/create</code></li> <li>Integra\u00e7\u00e3o: Lambda <code>url-shortener-create</code></li> <li>CORS: Habilitado</li> </ul> <ul> <li>M\u00e9todo: <code>GET</code></li> <li>Path: <code>/{code}</code></li> <li>Integra\u00e7\u00e3o: Lambda <code>url-shortener-redirect</code></li> <li>CORS: Habilitado</li> </ul>"},{"location":"getting-started/#3-deploy-da-api","title":"3. Deploy da API","text":"<pre><code># Fazer deploy da API\naws apigateway create-deployment \\\n    --rest-api-id SEU-API-ID \\\n    --stage-name prod\n</code></pre>"},{"location":"getting-started/#testando-o-sistema","title":"Testando o Sistema","text":""},{"location":"getting-started/#1-criar-url-encurtada","title":"1. Criar URL Encurtada","text":"<pre><code># Substitua pela sua URL da API\nexport API_URL=\"https://sua-api-id.execute-api.us-east-1.amazonaws.com/prod\"\n\n# Criar URL encurtada\ncurl -X POST $API_URL/create \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"originalUrl\": \"https://github.com/seu-usuario/url-shortener-system\",\n    \"expirationTime\": \"1735689600\"\n  }'\n</code></pre> <p>Resposta esperada: <pre><code>{\n  \"code\": \"a1b2c3d4\"\n}\n</code></pre></p>"},{"location":"getting-started/#2-testar-redirecionamento","title":"2. Testar Redirecionamento","text":"<pre><code># Testar redirecionamento\ncurl -I $API_URL/a1b2c3d4\n</code></pre> <p>Resposta esperada: <pre><code>HTTP/2 302 \nlocation: https://github.com/seu-usuario/url-shortener-system\n</code></pre></p>"},{"location":"getting-started/#resolucao-de-problemas-comuns","title":"Resolu\u00e7\u00e3o de Problemas Comuns","text":""},{"location":"getting-started/#lambda-nao-esta-executando","title":"Lambda n\u00e3o est\u00e1 executando","text":"<p>Erro: Timeout ou erro de permiss\u00e3o</p> <p>Solu\u00e7\u00e3o:</p> <ol> <li>Verificar se a role IAM tem as permiss\u00f5es corretas</li> <li>Aumentar timeout da fun\u00e7\u00e3o (m\u00e1ximo 15 minutos)</li> <li>Verificar logs no CloudWatch</li> </ol>"},{"location":"getting-started/#bucket-s3-nao-encontrado","title":"Bucket S3 n\u00e3o encontrado","text":"<p>Erro: NoSuchBucket</p> <p>Solu\u00e7\u00e3o:</p> <ol> <li>Verificar se o nome do bucket no c\u00f3digo coincide com o criado</li> <li>Verificar se o bucket est\u00e1 na mesma regi\u00e3o da Lambda</li> <li>Confirmar se o bucket foi criado com sucesso</li> </ol>"},{"location":"getting-started/#api-gateway-retorna-erro-500","title":"API Gateway retorna erro 500","text":"<p>Erro: Internal Server Error</p> <p>Solu\u00e7\u00e3o:</p> <ol> <li>Verificar logs da Lambda no CloudWatch</li> <li>Confirmar se o handler est\u00e1 correto</li> <li>Testar a Lambda diretamente (sem API Gateway)</li> </ol>"},{"location":"getting-started/#monitoramento","title":"Monitoramento","text":""},{"location":"getting-started/#cloudwatch-logs","title":"CloudWatch Logs","text":"<p>Acesse os logs das suas fun\u00e7\u00f5es em: </p> <ul> <li>Create URL: <code>/aws/lambda/url-shortener-create</code> </li> <li>Redirect URL: <code>/aws/lambda/url-shortener-redirect</code> </li> </ul> <p>M\u00e9tricas Importantes:</p> <ul> <li>Invocations: N\u00famero de execu\u00e7\u00f5es</li> <li>Duration: Tempo de execu\u00e7\u00e3o</li> <li>Errors: N\u00famero de erros</li> <li>Throttles: Execu\u00e7\u00f5es limitadas</li> </ul>"},{"location":"getting-started/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<p>Agora que o sistema est\u00e1 funcionando, voc\u00ea pode:</p> <ol> <li>Explorar a Arquitetura - Entender como tudo funciona</li> <li>Consultar a API Reference - Documenta\u00e7\u00e3o completa das APIs</li> <li>Configurar Monitoramento - Logs e alertas avan\u00e7ados</li> </ol> <p>Parab\u00e9ns!</p> <p>Seu URL Shortener System est\u00e1 funcionando! Agora voc\u00ea tem um sistema serverless completo rodando na AWS.</p>"},{"location":"advanced/monitoring/","title":"Monitoring &amp; Observability","text":"<p>Este guia aborda as estrat\u00e9gias de monitoramento, logging e observabilidade para o URL Shortener System, incluindo configura\u00e7\u00f5es do AWS CloudWatch e m\u00e9tricas importantes a serem acompanhadas.</p>"},{"location":"advanced/monitoring/#visao-geral-do-monitoramento","title":"Vis\u00e3o Geral do Monitoramento","text":"<p>O sistema utiliza os servi\u00e7os nativos da AWS para observabilidade:</p> <pre><code>graph TD\n    A[Lambda Functions] --&gt; B[CloudWatch Logs]\n    A --&gt; C[CloudWatch Metrics]\n    C --&gt; D[CloudWatch Alarms]\n    D --&gt; E[SNS Notifications]\n    B --&gt; F[Log Insights]\n    G[API Gateway] --&gt; C\n    H[S3] --&gt; C</code></pre>"},{"location":"advanced/monitoring/#metricas-principais","title":"M\u00e9tricas Principais","text":""},{"location":"advanced/monitoring/#lambda-functions","title":"Lambda Functions","text":""},{"location":"advanced/monitoring/#create-url-service","title":"Create URL Service","text":"M\u00e9trica Descri\u00e7\u00e3o Threshold Recomendado <code>Duration</code> Tempo de execu\u00e7\u00e3o &lt; 5000ms <code>Errors</code> N\u00famero de erros &lt; 1% das invoca\u00e7\u00f5es <code>Throttles</code> Execu\u00e7\u00f5es limitadas 0 <code>Invocations</code> Total de execu\u00e7\u00f5es - <code>ConcurrentExecutions</code> Execu\u00e7\u00f5es simult\u00e2neas &lt; 80% do limite"},{"location":"advanced/monitoring/#redirect-url-service","title":"Redirect URL Service","text":"M\u00e9trica Descri\u00e7\u00e3o Threshold Recomendado <code>Duration</code> Tempo de execu\u00e7\u00e3o &lt; 3000ms <code>Errors</code> N\u00famero de erros &lt; 2% das invoca\u00e7\u00f5es <code>DeadLetterErrors</code> Erros n\u00e3o tratados 0 <code>Invocations</code> Total de execu\u00e7\u00f5es -"},{"location":"advanced/monitoring/#api-gateway","title":"API Gateway","text":"M\u00e9trica Descri\u00e7\u00e3o Threshold Recomendado <code>4XXError</code> Erros do cliente &lt; 5% <code>5XXError</code> Erros do servidor &lt; 1% <code>Latency</code> Lat\u00eancia das requisi\u00e7\u00f5es &lt; 2000ms <code>Count</code> N\u00famero de requisi\u00e7\u00f5es -"},{"location":"advanced/monitoring/#amazon-s3","title":"Amazon S3","text":"M\u00e9trica Descri\u00e7\u00e3o Threshold Recomendado <code>4xxErrors</code> Erros de acesso &lt; 1% <code>FirstByteLatency</code> Lat\u00eancia do primeiro byte &lt; 100ms <code>TotalRequestLatency</code> Lat\u00eancia total &lt; 200ms"},{"location":"advanced/monitoring/#configuracao-de-logs","title":"Configura\u00e7\u00e3o de Logs","text":""},{"location":"advanced/monitoring/#cloudwatch-log-groups","title":"CloudWatch Log Groups","text":"<pre><code># Log Groups criados automaticamente\n/aws/lambda/CreateUrlLambda\n/aws/lambda/RedirectUrlShortner\n/aws/apigateway/url-shortener-api\n</code></pre>"},{"location":"advanced/monitoring/#estrutura-de-logs-recomendada","title":"Estrutura de Logs Recomendada","text":"Create URL ServiceRedirect URL Service <pre><code>// Exemplo de logging estruturado\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\npublic class Main {\n    private static final Logger logger = LoggerFactory.getLogger(Main.class);\n\n    @Override\n    public Map&lt;String, String&gt; handleRequest(Map&lt;String, Object&gt; input, Context context) {\n        String requestId = context.getAwsRequestId();\n\n        logger.info(\"Processing request: {}\", requestId);\n\n        try {\n            // L\u00f3gica do servi\u00e7o\n            String shortCode = processUrl(originalUrl);\n\n            logger.info(\"URL created successfully - RequestId: {}, Code: {}, OriginalUrl: {}\", \n                       requestId, shortCode, originalUrl);\n\n            return response;\n        } catch (Exception e) {\n            logger.error(\"Error processing request - RequestId: {}, Error: {}\", \n                        requestId, e.getMessage(), e);\n            throw e;\n        }\n    }\n}\n</code></pre> <pre><code>// Logging para redirecionamento\nlogger.info(\"Redirect request - RequestId: {}, Code: {}\", requestId, shortCode);\n\nif (urlData.getExpirationTime() &lt; currentTime) {\n    logger.warn(\"Expired URL accessed - RequestId: {}, Code: {}, ExpiredAt: {}\", \n               requestId, shortCode, urlData.getExpirationTime());\n    return expiredResponse;\n}\n\nlogger.info(\"Successful redirect - RequestId: {}, Code: {}, Target: {}\", \n           requestId, shortCode, urlData.getOriginalUrl());\n</code></pre>"},{"location":"advanced/monitoring/#alertas-e-alarmes","title":"Alertas e Alarmes","text":""},{"location":"advanced/monitoring/#alarmes-criticos","title":"Alarmes Cr\u00edticos","text":""},{"location":"advanced/monitoring/#high-error-rate","title":"High Error Rate","text":"<pre><code>AlarmName: URLShortener-HighErrorRate\nMetricName: Errors\nThreshold: 5 # 5 erros em 5 minutos\nComparisonOperator: GreaterThanThreshold\nEvaluationPeriods: 1\nPeriod: 300\n</code></pre>"},{"location":"advanced/monitoring/#high-latency","title":"High Latency","text":"<pre><code>AlarmName: URLShortener-HighLatency\nMetricName: Duration\nThreshold: 5000 # 5 segundos\nComparisonOperator: GreaterThanThreshold\nEvaluationPeriods: 2\nPeriod: 300\n</code></pre>"},{"location":"advanced/monitoring/#lambda-throttling","title":"Lambda Throttling","text":"<pre><code>AlarmName: URLShortener-Throttling\nMetricName: Throttles\nThreshold: 1\nComparisonOperator: GreaterThanOrEqualToThreshold\nEvaluationPeriods: 1\nPeriod: 60\n</code></pre>"},{"location":"advanced/monitoring/#configuracao-via-cloudformation","title":"Configura\u00e7\u00e3o via CloudFormation","text":"<pre><code>Resources:\n  HighErrorRateAlarm:\n    Type: AWS::CloudWatch::Alarm\n    Properties:\n      AlarmName: !Sub \"${AWS::StackName}-HighErrorRate\"\n      AlarmDescription: \"High error rate in URL Shortener\"\n      MetricName: Errors\n      Namespace: AWS/Lambda\n      Statistic: Sum\n      Period: 300\n      EvaluationPeriods: 1\n      Threshold: 5\n      ComparisonOperator: GreaterThanThreshold\n      Dimensions:\n        - Name: FunctionName\n          Value: !Ref CreateUrlFunction\n      AlarmActions:\n        - !Ref SNSTopic\n\n  SNSTopic:\n    Type: AWS::SNS::Topic\n    Properties:\n      DisplayName: \"URL Shortener Alerts\"\n      Subscription:\n        - Protocol: email\n          Endpoint: admin@exemplo.com\n</code></pre>"},{"location":"advanced/monitoring/#dashboards","title":"Dashboards","text":""},{"location":"advanced/monitoring/#cloudwatch-dashboard-principal","title":"CloudWatch Dashboard Principal","text":"<pre><code>{\n  \"widgets\": [\n    {\n      \"type\": \"metric\",\n      \"properties\": {\n        \"metrics\": [\n          [\"AWS/Lambda\", \"Invocations\", \"FunctionName\", \"CreateUrlLambda\"],\n          [\"AWS/Lambda\", \"Invocations\", \"FunctionName\", \"RedirectUrlShortner\"]\n        ],\n        \"period\": 300,\n        \"stat\": \"Sum\",\n        \"region\": \"us-east-1\",\n        \"title\": \"Lambda Invocations\"\n      }\n    },\n    {\n      \"type\": \"metric\",\n      \"properties\": {\n        \"metrics\": [\n          [\"AWS/Lambda\", \"Duration\", \"FunctionName\", \"CreateUrlLambda\"],\n          [\"AWS/Lambda\", \"Duration\", \"FunctionName\", \"RedirectUrlShortner\"]\n        ],\n        \"period\": 300,\n        \"stat\": \"Average\",\n        \"region\": \"us-east-1\",\n        \"title\": \"Average Duration\"\n      }\n    },\n    {\n      \"type\": \"metric\",\n      \"properties\": {\n        \"metrics\": [\n          [\"AWS/Lambda\", \"Errors\", \"FunctionName\", \"CreateUrlLambda\"],\n          [\"AWS/Lambda\", \"Errors\", \"FunctionName\", \"RedirectUrlShortner\"]\n        ],\n        \"period\": 300,\n        \"stat\": \"Sum\",\n        \"region\": \"us-east-1\",\n        \"title\": \"Errors\"\n      }\n    }\n  ]\n}\n</code></pre>"},{"location":"advanced/monitoring/#log-insights-queries","title":"Log Insights Queries","text":""},{"location":"advanced/monitoring/#queries-uteis-para-troubleshooting","title":"Queries \u00dateis para Troubleshooting","text":""},{"location":"advanced/monitoring/#top-errors","title":"Top Errors","text":"<pre><code>fields @timestamp, @message\n| filter @message like /ERROR/\n| stats count() by bin(5m)\n| sort @timestamp desc\n</code></pre>"},{"location":"advanced/monitoring/#slow-requests","title":"Slow Requests","text":"<pre><code>fields @timestamp, @duration, @requestId\n| filter @duration &gt; 3000\n| sort @duration desc\n| limit 100\n</code></pre>"},{"location":"advanced/monitoring/#url-creation-analysis","title":"URL Creation Analysis","text":"<pre><code>fields @timestamp, @message\n| filter @message like /URL created successfully/\n| parse @message \"Code: *, OriginalUrl: *\" as shortCode, originalUrl\n| stats count() by bin(1h)\n</code></pre>"},{"location":"advanced/monitoring/#expired-urls-access","title":"Expired URLs Access","text":"<pre><code>fields @timestamp, @message\n| filter @message like /Expired URL accessed/\n| parse @message \"Code: *, ExpiredAt: *\" as shortCode, expiredAt\n| stats count() by shortCode\n| sort count desc\n</code></pre>"},{"location":"advanced/monitoring/#metricas-customizadas","title":"M\u00e9tricas Customizadas","text":""},{"location":"advanced/monitoring/#implementacao-de-metricas-de-negocio","title":"Implementa\u00e7\u00e3o de M\u00e9tricas de Neg\u00f3cio","text":"<pre><code>import software.amazon.awssdk.services.cloudwatch.CloudWatchClient;\nimport software.amazon.awssdk.services.cloudwatch.model.*;\n\npublic class MetricsHelper {\n    private final CloudWatchClient cloudWatch = CloudWatchClient.create();\n\n    public void recordUrlCreated(String region) {\n        putMetric(\"URLShortener/Business\", \"URLsCreated\", 1.0, \n                 Map.of(\"Region\", region));\n    }\n\n    public void recordUrlAccessed(String shortCode, boolean expired) {\n        putMetric(\"URLShortener/Business\", \"URLsAccessed\", 1.0, \n                 Map.of(\"Status\", expired ? \"Expired\" : \"Success\"));\n    }\n\n    private void putMetric(String namespace, String metricName, \n                          Double value, Map&lt;String, String&gt; dimensions) {\n        List&lt;Dimension&gt; dims = dimensions.entrySet().stream()\n            .map(entry -&gt; Dimension.builder()\n                .name(entry.getKey())\n                .value(entry.getValue())\n                .build())\n            .collect(Collectors.toList());\n\n        MetricDatum datum = MetricDatum.builder()\n            .metricName(metricName)\n            .value(value)\n            .dimensions(dims)\n            .build();\n\n        PutMetricDataRequest request = PutMetricDataRequest.builder()\n            .namespace(namespace)\n            .metricData(datum)\n            .build();\n\n        cloudWatch.putMetricData(request);\n    }\n}\n</code></pre>"},{"location":"advanced/monitoring/#troubleshooting-playbook","title":"Troubleshooting Playbook","text":""},{"location":"advanced/monitoring/#problema-alta-latencia","title":"Problema: Alta Lat\u00eancia","text":"<p>Sintomas: </p> <ul> <li>Duration &gt; 5000ms  </li> <li>Timeouts frequentes</li> </ul> <p>Investiga\u00e7\u00e3o: </p> <ol> <li>Verificar logs de performance  </li> <li>Analisar cold starts  </li> <li>Verificar lat\u00eancia do S3  </li> </ol> <p>Solu\u00e7\u00f5es: </p> <ul> <li>Provisioned Concurrency para evitar cold starts  </li> <li>Otimizar c\u00f3digo Java  </li> <li>Usar S3 Transfer Acceleration  </li> </ul>"},{"location":"advanced/monitoring/#problema-errors-5xx","title":"Problema: Errors 5XX","text":"<p>Sintomas: </p> <ul> <li>Errors &gt; 1% das invoca\u00e7\u00f5es  </li> <li>Falhas de acesso ao S3  </li> </ul> <p>Investiga\u00e7\u00e3o: <pre><code>fields @timestamp, @message\n| filter @message like /Error/\n| stats count() by bin(5m)\n</code></pre></p> <p>Solu\u00e7\u00f5es: </p> <ul> <li>Verificar permiss\u00f5es IAM  </li> <li>Implementar retry autom\u00e1tico  </li> <li>Validar configura\u00e7\u00e3o do S3  </li> </ul>"},{"location":"advanced/monitoring/#problema-throttling","title":"Problema: Throttling","text":"<p>Sintomas: </p> <ul> <li>Throttles &gt; 0  </li> <li>429 Too Many Requests  </li> </ul> <p>Investiga\u00e7\u00e3o: </p> <ul> <li>Verificar limites de concorr\u00eancia  </li> <li>Analisar padr\u00f5es de tr\u00e1fego  </li> </ul> <p>Solu\u00e7\u00f5es: </p> <ul> <li>Aumentar Reserved Concurrency  </li> <li>Implementar backoff exponencial  </li> <li>Distribuir carga temporalmente  </li> </ul>"},{"location":"advanced/monitoring/#monitoramento-mobileweb","title":"Monitoramento Mobile/Web","text":""},{"location":"advanced/monitoring/#health-check-endpoint","title":"Health Check Endpoint","text":"<pre><code>// Endpoint adicional para health check\n@Override\npublic Map&lt;String, Object&gt; healthCheck(Map&lt;String, Object&gt; input, Context context) {\n    Map&lt;String, Object&gt; response = new HashMap&lt;&gt;();\n\n    try {\n        // Testar conectividade com S3\n        s3Client.headBucket(HeadBucketRequest.builder()\n                           .bucket(\"aws-url-shortner-app\")\n                           .build());\n\n        response.put(\"status\", \"healthy\");\n        response.put(\"timestamp\", System.currentTimeMillis());\n        response.put(\"version\", \"1.0.0\");\n    } catch (Exception e) {\n        response.put(\"status\", \"unhealthy\");\n        response.put(\"error\", e.getMessage());\n    }\n\n    return response;\n}\n</code></pre>"},{"location":"advanced/monitoring/#checklist-de-monitoramento","title":"Checklist de Monitoramento","text":""},{"location":"advanced/monitoring/#setup-inicial","title":"Setup Inicial","text":"<ul> <li> CloudWatch Logs habilitados</li> <li> M\u00e9tricas b\u00e1sicas configuradas</li> <li> Alarmes cr\u00edticos criados</li> <li> Dashboard principal configurado</li> <li> SNS topic para alertas</li> </ul>"},{"location":"advanced/monitoring/#monitoramento-continuo","title":"Monitoramento Cont\u00ednuo","text":"<ul> <li> Revisar m\u00e9tricas diariamente</li> <li> Analisar logs de erro semanalmente</li> <li> Ajustar thresholds mensalmente</li> <li> Documentar incidentes</li> <li> Otimizar performance baseado em dados</li> </ul>"},{"location":"advanced/monitoring/#alertas-configurados","title":"Alertas Configurados","text":"<ul> <li> High error rate (&gt; 1%)</li> <li> High latency (&gt; 5s)</li> <li> Lambda throttling</li> <li> S3 errors</li> <li> API Gateway 5XX errors</li> </ul>"},{"location":"advanced/troubleshooting/","title":"Troubleshooting Guide","text":"<p>Este guia ajuda a identificar e resolver problemas comuns no URL Shortener System.</p>"},{"location":"advanced/troubleshooting/#diagnostico-rapido","title":"Diagn\u00f3stico R\u00e1pido","text":""},{"location":"advanced/troubleshooting/#verificacao-de-status-dos-servicos","title":"Verifica\u00e7\u00e3o de Status dos Servi\u00e7os","text":"Create URL ServiceRedirect ServiceS3 Bucket <pre><code># Teste b\u00e1sico de cria\u00e7\u00e3o\ncurl -X POST https://your-api-gateway.com/create \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"originalUrl\": \"https://google.com\",\n    \"expirationTime\": \"9999999999\"\n  }'\n</code></pre> <pre><code># Teste de redirecionamento\ncurl -I https://your-api-gateway.com/test-code\n</code></pre> <pre><code># Verificar se bucket existe\naws s3 ls s3://aws-url-shortner-app/\n</code></pre>"},{"location":"advanced/troubleshooting/#problemas-comuns","title":"Problemas Comuns","text":""},{"location":"advanced/troubleshooting/#1-error-500-internal-server-error","title":"1. Error 500 - Internal Server Error","text":""},{"location":"advanced/troubleshooting/#sintomas","title":"Sintomas","text":"<ul> <li>API retorna erro 500</li> <li>Lambda function falha na execu\u00e7\u00e3o</li> </ul>"},{"location":"advanced/troubleshooting/#possiveis-causas-solucoes","title":"Poss\u00edveis Causas &amp; Solu\u00e7\u00f5es","text":"<p>Permiss\u00f5es IAM Incorretas</p> <p>Problema: Lambda n\u00e3o tem permiss\u00e3o para acessar S3</p> <p>Solu\u00e7\u00e3o: <pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:PutObject\"\n      ],\n      \"Resource\": \"arn:aws:s3:::aws-url-shortner-app/*\"\n    }\n  ]\n}\n</code></pre></p> <p>Bucket S3 N\u00e3o Existe</p> <p>Problema: Bucket <code>aws-url-shortner-app</code> n\u00e3o foi criado</p> <p>Solu\u00e7\u00e3o: <pre><code>aws s3 mb s3://aws-url-shortner-app\n</code></pre></p> <p>Timeout da Lambda</p> <p>Problema: Fun\u00e7\u00e3o excede tempo limite padr\u00e3o (3s)</p> <p>Solu\u00e7\u00e3o: - Aumentar timeout para 30s no console AWS - Ou via CLI: <code>aws lambda update-function-configuration --function-name YourFunction --timeout 30</code></p>"},{"location":"advanced/troubleshooting/#2-error-400-bad-request","title":"2. Error 400 - Bad Request","text":""},{"location":"advanced/troubleshooting/#sintomas_1","title":"Sintomas","text":"<ul> <li>Requisi\u00e7\u00e3o rejeitada com erro 400</li> <li>Mensagem \"Error parsing JSON body\"</li> </ul>"},{"location":"advanced/troubleshooting/#solucoes","title":"Solu\u00e7\u00f5es","text":"<p>JSON Malformado</p> <p>Verificar: <pre><code># \u2705 Correto\ncurl -X POST https://api.com/create \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"originalUrl\":\"https://example.com\",\"expirationTime\":\"1672531200\"}'\n\n# \u274c Incorreto (faltam aspas)\ncurl -X POST https://api.com/create \\\n  -H \"Content-Type: application/json\" \\\n  -d '{originalUrl:https://example.com,expirationTime:1672531200}'\n</code></pre></p> <p>Content-Type Ausente</p> <p>Sempre incluir header: <code>Content-Type: application/json</code></p>"},{"location":"advanced/troubleshooting/#3-error-410-gone","title":"3. Error 410 - Gone","text":""},{"location":"advanced/troubleshooting/#sintomas_2","title":"Sintomas","text":"<ul> <li>URL retorna \"This URL has expired\"</li> <li>Redirecionamento n\u00e3o funciona</li> </ul>"},{"location":"advanced/troubleshooting/#explicacao","title":"Explica\u00e7\u00e3o","text":"<p>Este \u00e9 o comportamento esperado para URLs expiradas.</p> <p>Verificar tempo de expira\u00e7\u00e3o: <pre><code># Verificar conte\u00fado do arquivo no S3\naws s3 cp s3://aws-url-shortner-app/your-code.json - | jq .\n\n# Comparar com timestamp atual\ndate +%s\n</code></pre></p>"},{"location":"advanced/troubleshooting/#4-error-404-not-found","title":"4. Error 404 - Not Found","text":""},{"location":"advanced/troubleshooting/#sintomas_3","title":"Sintomas","text":"<ul> <li>C\u00f3digo de URL n\u00e3o encontrado</li> <li>Lambda retorna erro ao buscar no S3</li> </ul>"},{"location":"advanced/troubleshooting/#possiveis-causas","title":"Poss\u00edveis Causas","text":"<p>C\u00f3digo Inexistente</p> <p>Problema: C\u00f3digo nunca foi criado ou foi deletado</p> <p>Verifica\u00e7\u00e3o: <pre><code>aws s3 ls s3://aws-url-shortner-app/ | grep your-code\n</code></pre></p> <p>Caracteres Especiais na URL</p> <p>Problema: C\u00f3digos com caracteres especiais podem causar problemas</p> <p>Verifica\u00e7\u00e3o: C\u00f3digos devem conter apenas [a-zA-Z0-9]</p>"},{"location":"advanced/troubleshooting/#5-cors-issues","title":"5. CORS Issues","text":""},{"location":"advanced/troubleshooting/#sintomas_4","title":"Sintomas","text":"<ul> <li>Erro CORS no navegador</li> <li>\"Access-Control-Allow-Origin\" ausente</li> </ul>"},{"location":"advanced/troubleshooting/#solucao-api-gateway","title":"Solu\u00e7\u00e3o - API Gateway","text":"<pre><code># Configurar CORS no API Gateway\nResources:\n  ApiGatewayCorsConfig:\n    Type: AWS::ApiGateway::Method\n    Properties:\n      HttpMethod: OPTIONS\n      Integration:\n        IntegrationResponses:\n          - StatusCode: 200\n            ResponseParameters:\n              method.response.header.Access-Control-Allow-Headers: \"'Content-Type,X-Amz-Date,Authorization'\"\n              method.response.header.Access-Control-Allow-Methods: \"'GET,POST,OPTIONS'\"\n              method.response.header.Access-Control-Allow-Origin: \"'*'\"\n</code></pre>"},{"location":"advanced/troubleshooting/#debugging-detalhado","title":"Debugging Detalhado","text":""},{"location":"advanced/troubleshooting/#verificar-logs-do-cloudwatch","title":"Verificar Logs do CloudWatch","text":"Via Console AWSVia CLI <ol> <li>Acesse CloudWatch \u2192 Log Groups</li> <li>Procure por <code>/aws/lambda/your-function-name</code></li> <li>Verifique logs mais recentes</li> </ol> <pre><code># Listar log groups\naws logs describe-log-groups --log-group-name-prefix \"/aws/lambda/\"\n\n# Ver logs recentes\naws logs tail /aws/lambda/your-function-name --follow\n</code></pre>"},{"location":"advanced/troubleshooting/#testar-lambda-localmente","title":"Testar Lambda Localmente","text":"<p>Para testar sem deploy:</p> <pre><code># Instalar SAM CLI\npip install aws-sam-cli\n\n# Criar template.yaml b\u00e1sico\ncat &gt; template.yaml &lt;&lt; EOF\nAWSTemplateFormatVersion: '2010-09-09'\nTransform: AWS::Serverless-2016-10-31\nResources:\n  CreateUrlFunction:\n    Type: AWS::Serverless::Function\n    Properties:\n      CodeUri: CreateUrlLambda/target/\n      Handler: com.rocketseat.createUrlShortner.Main::handleRequest\n      Runtime: java17\n      Events:\n        CreateUrl:\n          Type: Api\n          Properties:\n            Path: /create\n            Method: post\nEOF\n\n# Testar localmente\nsam local start-api\n</code></pre>"},{"location":"advanced/troubleshooting/#validar-configuracao-do-maven","title":"Validar Configura\u00e7\u00e3o do Maven","text":"<pre><code># Verificar se JAR foi gerado corretamente\ncd CreateUrlLambda\nmvn clean package\nls -la target/\n\n# JAR deve existir e ter depend\u00eancias inclu\u00eddas (shade plugin)\njar -tf target/CreateUrlLambda-1.0-SNAPSHOT.jar | grep -E \"(aws|jackson|lombok)\"\n</code></pre>"},{"location":"advanced/troubleshooting/#monitoramento-e-metricas","title":"Monitoramento e M\u00e9tricas","text":""},{"location":"advanced/troubleshooting/#metricas-importantes","title":"M\u00e9tricas Importantes","text":"M\u00e9trica O que indica Valor normal Duration Tempo de execu\u00e7\u00e3o &lt; 5000ms Errors Falhas na execu\u00e7\u00e3o &lt; 1% Throttles Limita\u00e7\u00e3o de concorr\u00eancia 0 Invocations N\u00famero de execu\u00e7\u00f5es Conforme uso"},{"location":"advanced/troubleshooting/#alertas-recomendados","title":"Alertas Recomendados","text":"<pre><code># Criar alerta para errors &gt; 5%\naws cloudwatch put-metric-alarm \\\n  --alarm-name \"Lambda-High-Error-Rate\" \\\n  --alarm-description \"Lambda error rate &gt; 5%\" \\\n  --metric-name \"Errors\" \\\n  --namespace \"AWS/Lambda\" \\\n  --statistic \"Sum\" \\\n  --period 300 \\\n  --threshold 5 \\\n  --comparison-operator \"GreaterThanThreshold\"\n</code></pre>"},{"location":"advanced/troubleshooting/#ferramentas-de-debug","title":"Ferramentas de Debug","text":""},{"location":"advanced/troubleshooting/#1-postman-collection","title":"1. Postman Collection","text":"<p>Criar collection para testes:</p> <pre><code>{\n  \"info\": {\n    \"name\": \"URL Shortener Tests\"\n  },\n  \"item\": [\n    {\n      \"name\": \"Create URL\",\n      \"request\": {\n        \"method\": \"POST\",\n        \"header\": [\n          {\n            \"key\": \"Content-Type\",\n            \"value\": \"application/json\"\n          }\n        ],\n        \"body\": {\n          \"raw\": \"{\\n  \\\"originalUrl\\\": \\\"https://google.com\\\",\\n  \\\"expirationTime\\\": \\\"9999999999\\\"\\n}\"\n        },\n        \"url\": {\n          \"raw\": \"{{api_url}}/create\"\n        }\n      }\n    }\n  ]\n}\n</code></pre>"},{"location":"advanced/troubleshooting/#2-script-de-teste-automatizado","title":"2. Script de Teste Automatizado","text":"<pre><code>#!/bin/bash\n# test-system.sh\n\nAPI_URL=\"https://your-api-gateway.com\"\n\necho \"\ud83e\uddea Testando cria\u00e7\u00e3o de URL...\"\nRESPONSE=$(curl -s -X POST $API_URL/create \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"originalUrl\":\"https://google.com\",\"expirationTime\":\"9999999999\"}')\n\nCODE=$(echo $RESPONSE | jq -r '.code')\necho \"\u2705 C\u00f3digo gerado: $CODE\"\n\necho \"\ud83e\uddea Testando redirecionamento...\"\nHTTP_STATUS=$(curl -s -o /dev/null -w \"%{http_code}\" $API_URL/$CODE)\n\nif [ \"$HTTP_STATUS\" = \"302\" ]; then\n    echo \"\u2705 Redirecionamento funcionando\"\nelse\n    echo \"\u274c Erro no redirecionamento: $HTTP_STATUS\"\nfi\n</code></pre>"},{"location":"advanced/troubleshooting/#quando-buscar-ajuda","title":"Quando Buscar Ajuda","text":"<p>Se ap\u00f3s seguir este guia o problema persistir:</p> <p>Colete informa\u00e7\u00f5es:</p> <ul> <li>Logs do CloudWatch  </li> <li>C\u00f3digo de erro espec\u00edfico  </li> <li>Payload da requisi\u00e7\u00e3o  </li> <li>Timestamp do erro  </li> </ul> <p>Verifique:  </p> <ul> <li>Status dos servi\u00e7os AWS  </li> <li>Quotas e limites da conta  </li> <li>Configura\u00e7\u00f5es de rede/VPC  </li> </ul> <p>Recursos adicionais:  </p> <ul> <li>AWS Lambda Troubleshooting </li> <li>S3 Error Codes </li> <li>API Gateway Issues </li> </ul>"},{"location":"api/create-url/","title":"Create URL Service API","text":"<p>O Create URL Service \u00e9 respons\u00e1vel por gerar URLs encurtadas e armazen\u00e1-las no Amazon S3. Este servi\u00e7o implementa a funcionalidade principal de cria\u00e7\u00e3o do sistema de encurtamento de URLs.</p>"},{"location":"api/create-url/#visao-geral","title":"Vis\u00e3o Geral","text":"Propriedade Valor M\u00e9todo HTTP <code>POST</code> Endpoint <code>/create</code> Content-Type <code>application/json</code> AWS Lambda <code>CreateUrlLambda</code> Handler <code>com.rocketseat.createUrlShortner.Main::handleRequest</code>"},{"location":"api/create-url/#endpoint","title":"Endpoint","text":"<pre><code>POST https://your-api-gateway-url.com/create\n</code></pre>"},{"location":"api/create-url/#request","title":"Request","text":""},{"location":"api/create-url/#headers","title":"Headers","text":"<pre><code>Content-Type: application/json\n</code></pre>"},{"location":"api/create-url/#body-schema","title":"Body Schema","text":"<pre><code>{\n  \"originalUrl\": \"string\",\n  \"expirationTime\": \"string\"\n}\n</code></pre>"},{"location":"api/create-url/#parametros","title":"Par\u00e2metros","text":"Campo Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o <code>originalUrl</code> <code>string</code> \u2705 URL original que ser\u00e1 encurtada <code>expirationTime</code> <code>string</code> \u2705 Timestamp Unix em segundos para expira\u00e7\u00e3o <p>Formato do expirationTime</p> <p>O campo <code>expirationTime</code> deve ser um timestamp Unix em segundos (n\u00e3o milissegundos).</p> <p>Exemplo: <code>1672531200</code> = 1\u00ba de Janeiro de 2023, 00:00:00 UTC</p>"},{"location":"api/create-url/#exemplo-de-request","title":"Exemplo de Request","text":"cURLJavaScriptPython <pre><code>curl -X POST https://your-api-gateway-url.com/create \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"originalUrl\": \"https://exemplo.com/artigo-muito-longo-sobre-tecnologia\",\n    \"expirationTime\": \"1672531200\"\n  }'\n</code></pre> <pre><code>const response = await fetch('https://your-api-gateway-url.com/create', {\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  body: JSON.stringify({\n    originalUrl: 'https://exemplo.com/artigo-muito-longo-sobre-tecnologia',\n    expirationTime: '1672531200'\n  })\n});\n\nconst data = await response.json();\nconsole.log('URL encurtada:', data.code);\n</code></pre> <pre><code>import requests\nimport json\n\nurl = \"https://your-api-gateway-url.com/create\"\npayload = {\n    \"originalUrl\": \"https://exemplo.com/artigo-muito-longo-sobre-tecnologia\",\n    \"expirationTime\": \"1672531200\"\n}\n\nresponse = requests.post(url, json=payload)\ndata = response.json()\nprint(f\"URL encurtada: {data['code']}\")\n</code></pre>"},{"location":"api/create-url/#response","title":"Response","text":""},{"location":"api/create-url/#success-response-200-ok","title":"Success Response (200 OK)","text":"<pre><code>{\n  \"code\": \"a1b2c3d4\"\n}\n</code></pre>"},{"location":"api/create-url/#campos-da-resposta","title":"Campos da Resposta","text":"Campo Tipo Descri\u00e7\u00e3o <code>code</code> <code>string</code> C\u00f3digo \u00fanico de 8 caracteres da URL encurtada <p>C\u00f3digo Gerado</p> <p>O c\u00f3digo \u00e9 gerado usando <code>UUID.randomUUID().toString().substring(0, 8)</code>, garantindo unicidade estat\u00edstica.</p>"},{"location":"api/create-url/#error-responses","title":"Error Responses","text":""},{"location":"api/create-url/#400-bad-request-json-invalido","title":"400 Bad Request - JSON Inv\u00e1lido","text":"<pre><code>{\n  \"errorMessage\": \"Error parsing JSON body: Unexpected character...\",\n  \"errorType\": \"RuntimeException\"\n}\n</code></pre>"},{"location":"api/create-url/#500-internal-server-error-erro-no-s3","title":"500 Internal Server Error - Erro no S3","text":"<pre><code>{\n  \"errorMessage\": \"Error saving data to S3: Access Denied\",\n  \"errorType\": \"RuntimeException\"\n}\n</code></pre>"},{"location":"api/create-url/#funcionamento-interno","title":"Funcionamento Interno","text":""},{"location":"api/create-url/#fluxo-de-processamento","title":"Fluxo de Processamento","text":"<pre><code>sequenceDiagram\n    participant C as Cliente\n    participant L as Lambda\n    participant S as S3\n\n    C-&gt;&gt;L: POST /create\n    Note over L: 1. Parse JSON body\n    Note over L: 2. Extrair originalUrl e expirationTime\n    Note over L: 3. Gerar c\u00f3digo \u00fanico (8 chars)\n    Note over L: 4. Criar objeto UrlData\n    L-&gt;&gt;S: putObject(code.json, urlData)\n    S--&gt;&gt;L: Success\n    L--&gt;&gt;C: { \"code\": \"a1b2c3d4\" }</code></pre>"},{"location":"api/create-url/#geracao-do-codigo","title":"Gera\u00e7\u00e3o do C\u00f3digo","text":"<pre><code>String shortUrlCode = UUID.randomUUID().toString().substring(0, 8);\n</code></pre> <ul> <li>M\u00e9todo: Primeiros 8 caracteres de um UUID v4</li> <li>Formato: Alfanum\u00e9rico (a-z, 0-9, h\u00edfen)</li> <li>Exemplo: <code>a1b2c3d4</code>, <code>7f8e9d2a</code>, <code>uuid-123</code></li> <li>Colis\u00f5es: Estatisticamente improv\u00e1veis para volume moderado</li> </ul>"},{"location":"api/create-url/#armazenamento-no-s3","title":"Armazenamento no S3","text":""},{"location":"api/create-url/#estrutura-do-objeto","title":"Estrutura do Objeto","text":"<pre><code>{\n  \"originalUrl\": \"https://exemplo.com/url-original\",\n  \"expirationTime\": 1672531200\n}\n</code></pre>"},{"location":"api/create-url/#configuracao-s3","title":"Configura\u00e7\u00e3o S3","text":"<ul> <li>Bucket: <code>aws-url-shortner-app</code></li> <li>Key: <code>{code}.json</code> (ex: <code>a1b2c3d4.json</code>)</li> <li>Content-Type: <code>application/json</code></li> </ul>"},{"location":"api/create-url/#seguranca-e-permissoes","title":"Seguran\u00e7a e Permiss\u00f5es","text":""},{"location":"api/create-url/#permissoes-iam-necessarias","title":"Permiss\u00f5es IAM Necess\u00e1rias","text":"<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:PutObject\"\n      ],\n      \"Resource\": \"arn:aws:s3:::aws-url-shortner-app/*\"\n    }\n  ]\n}\n</code></pre>"},{"location":"api/create-url/#consideracoes-de-seguranca","title":"Considera\u00e7\u00f5es de Seguran\u00e7a","text":"<p>Valida\u00e7\u00e3o de Entrada</p> <p>O servi\u00e7o atual n\u00e3o valida se a <code>originalUrl</code> \u00e9 uma URL v\u00e1lida. Em produ\u00e7\u00e3o, considere adicionar valida\u00e7\u00e3o.</p> <p>Rate Limiting</p> <p>Considere implementar rate limiting no API Gateway para prevenir abuso.</p>"},{"location":"api/create-url/#exemplos-avancados","title":"Exemplos Avan\u00e7ados","text":""},{"location":"api/create-url/#urls-com-diferentes-expiracoes","title":"URLs com Diferentes Expira\u00e7\u00f5es","text":"24 horas1 semanaSem expira\u00e7\u00e3o (100 anos) <pre><code># Expira em 24 horas a partir de agora\nEXPIRATION=$(date -d \"+1 day\" +%s)\n\ncurl -X POST https://your-api-gateway-url.com/create \\\n  -H \"Content-Type: application/json\" \\\n  -d \"{\n    \\\"originalUrl\\\": \\\"https://exemplo.com/artigo-temporario\\\",\n    \\\"expirationTime\\\": \\\"$EXPIRATION\\\"\n  }\"\n</code></pre> <pre><code># Expira em 1 semana\nEXPIRATION=$(date -d \"+1 week\" +%s)\n\ncurl -X POST https://your-api-gateway-url.com/create \\\n  -H \"Content-Type: application/json\" \\\n  -d \"{\n    \\\"originalUrl\\\": \\\"https://exemplo.com/campanha-semanal\\\",\n    \\\"expirationTime\\\": \\\"$EXPIRATION\\\"\n  }\"\n</code></pre> <pre><code># Expira em 100 anos (praticamente permanente)\nEXPIRATION=$(date -d \"+100 years\" +%s)\n\ncurl -X POST https://your-api-gateway-url.com/create \\\n  -H \"Content-Type: application/json\" \\\n  -d \"{\n    \\\"originalUrl\\\": \\\"https://exemplo.com/link-permanente\\\",\n    \\\"expirationTime\\\": \\\"$EXPIRATION\\\"\n  }\"\n</code></pre>"},{"location":"api/create-url/#troubleshooting","title":"Troubleshooting","text":""},{"location":"api/create-url/#erros-comuns","title":"Erros Comuns","text":""},{"location":"api/create-url/#json-malformado","title":"JSON Malformado","text":"<pre><code># \u274c Erro - JSON inv\u00e1lido\ncurl -X POST https://your-api-gateway-url.com/create \\\n  -H \"Content-Type: application/json\" \\\n  -d '{ \"originalUrl\": \"https://exemplo.com\" }'  # Missing expirationTime\n\n# \u2705 Correto\ncurl -X POST https://your-api-gateway-url.com/create \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"originalUrl\": \"https://exemplo.com\",\n    \"expirationTime\": \"1672531200\"\n  }'\n</code></pre>"},{"location":"api/create-url/#problemas-de-permissao-s3","title":"Problemas de Permiss\u00e3o S3","text":"<pre><code>// Erro t\u00edpico de permiss\u00e3o\n{\n  \"errorMessage\": \"Error saving data to S3: Access Denied (Service: S3, Status Code: 403)\",\n  \"errorType\": \"RuntimeException\"\n}\n</code></pre> <p>Solu\u00e7\u00e3o: Verificar se a role do Lambda tem permiss\u00e3o <code>s3:PutObject</code> no bucket correto.</p>"},{"location":"api/create-url/#metricas-e-monitoramento","title":"M\u00e9tricas e Monitoramento","text":""},{"location":"api/create-url/#cloudwatch-metrics","title":"CloudWatch Metrics","text":"<ul> <li>Invocations: N\u00famero de chamadas do Lambda</li> <li>Duration: Tempo de execu\u00e7\u00e3o</li> <li>Errors: N\u00famero de erros</li> <li>Throttles: Execu\u00e7\u00f5es limitadas</li> </ul>"},{"location":"api/create-url/#logs-uteis","title":"Logs \u00dateis","text":"<pre><code># Ver logs do Lambda\naws logs tail /aws/lambda/CreateUrlLambda --follow\n\n# Filtrar erros\naws logs filter-log-events \\\n  --log-group-name /aws/lambda/CreateUrlLambda \\\n  --filter-pattern \"ERROR\"\n</code></pre>"},{"location":"api/create-url/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Redirect URL Service - Como usar as URLs criadas</li> <li>Deployment Guide - Como fazer deploy</li> <li>Monitoring - Configurar observabilidade</li> </ul>"},{"location":"api/redirect-url/","title":"Redirect URL Service API","text":"<p>O Redirect URL Service \u00e9 respons\u00e1vel por resolver c\u00f3digos de URLs encurtadas e redirecionar os usu\u00e1rios para as URLs originais correspondentes.</p>"},{"location":"api/redirect-url/#overview","title":"Overview","text":"Propriedade Valor M\u00e9todo HTTP <code>GET</code> Endpoint <code>/{shortCode}</code> Fun\u00e7\u00e3o Redirecionamento para URL original Timeout 30 segundos Retries N\u00e3o aplic\u00e1vel (GET)"},{"location":"api/redirect-url/#endpoint","title":"Endpoint","text":"<pre><code>GET /{shortCode}\n</code></pre> <p>Onde <code>{shortCode}</code> \u00e9 o c\u00f3digo de 8 caracteres retornado pelo Create URL Service.</p>"},{"location":"api/redirect-url/#request","title":"Request","text":""},{"location":"api/redirect-url/#url-parameters","title":"URL Parameters","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o <code>shortCode</code> string \u2705 C\u00f3digo \u00fanico de 8 caracteres da URL encurtada"},{"location":"api/redirect-url/#headers","title":"Headers","text":"<p>Nenhum header espec\u00edfico \u00e9 necess\u00e1rio para esta requisi\u00e7\u00e3o.</p>"},{"location":"api/redirect-url/#exemplos-de-request","title":"Exemplos de Request","text":"cURLJavaScript (Fetch)Python (Requests) <pre><code>curl -I https://api.exemplo.com/a1b2c3d4\n</code></pre> <pre><code>fetch('https://api.exemplo.com/a1b2c3d4', {\n  method: 'GET',\n  redirect: 'follow'\n})\n.then(response =&gt; {\n  if (response.redirected) {\n    console.log('Redirecionado para:', response.url);\n  }\n});\n</code></pre> <pre><code>import requests\n\nresponse = requests.get('https://api.exemplo.com/a1b2c3d4', \n                       allow_redirects=True)\nprint(f\"URL final: {response.url}\")\n</code></pre>"},{"location":"api/redirect-url/#response","title":"Response","text":""},{"location":"api/redirect-url/#cenarios-de-resposta","title":"Cen\u00e1rios de Resposta","text":""},{"location":"api/redirect-url/#url-valida-sucesso","title":"URL V\u00e1lida (Sucesso)","text":"<p>Status Code: <code>302 Found</code></p> <pre><code>HTTP/1.1 302 Found\nLocation: https://exemplo.com/artigo-original-muito-longo\nContent-Length: 0\nDate: Wed, 04 Jun 2025 10:30:00 GMT\n</code></pre> <p>Redirecionamento Autom\u00e1tico</p> <p>O navegador automaticamente seguir\u00e1 o redirecionamento para a URL original.</p>"},{"location":"api/redirect-url/#url-expirada","title":"URL Expirada","text":"<p>Status Code: <code>410 Gone</code></p> <pre><code>HTTP/1.1 410 Gone\nContent-Type: text/plain\nContent-Length: 22\nDate: Wed, 04 Jun 2025 10:30:00 GMT\n\nThis URL has expired.\n</code></pre> <p>URL Expirada</p> <p>A URL encurtada ultrapassou seu tempo de vida \u00fatil definido na cria\u00e7\u00e3o.</p>"},{"location":"api/redirect-url/#url-nao-encontrada","title":"URL N\u00e3o Encontrada","text":"<p>Status Code: <code>500 Internal Server Error</code></p> <pre><code>HTTP/1.1 500 Internal Server Error\nContent-Type: application/json\nContent-Length: 85\nDate: Wed, 04 Jun 2025 10:30:00 GMT\n\n{\n  \"errorMessage\": \"Error fetching URL data from S3: The specified key does not exist.\"\n}\n</code></pre> <p>C\u00f3digo Inv\u00e1lido</p> <p>O c\u00f3digo fornecido n\u00e3o existe no sistema ou \u00e9 inv\u00e1lido.</p>"},{"location":"api/redirect-url/#status-codes","title":"Status Codes","text":"Status Descri\u00e7\u00e3o Cen\u00e1rio <code>302</code> Found URL v\u00e1lida - redirecionamento realizado <code>410</code> Gone URL expirou - n\u00e3o est\u00e1 mais dispon\u00edvel <code>500</code> Internal Server Error Erro interno ou c\u00f3digo n\u00e3o encontrado"},{"location":"api/redirect-url/#fluxo-de-redirecionamento","title":"Fluxo de Redirecionamento","text":"<pre><code>sequenceDiagram\n    participant C as Cliente\n    participant API as API Gateway\n    participant L as Lambda\n    participant S3 as Amazon S3\n\n    C-&gt;&gt;API: GET /{shortCode}\n    API-&gt;&gt;L: Invoke Lambda\n    L-&gt;&gt;S3: GetObject(shortCode.json)\n\n    alt URL encontrada e v\u00e1lida\n        S3--&gt;&gt;L: URL data\n        L-&gt;&gt;L: Validar expira\u00e7\u00e3o\n        L--&gt;&gt;API: 302 + Location header\n        API--&gt;&gt;C: 302 Found\n        C-&gt;&gt;C: Redirecionar para URL original\n    else URL expirada\n        S3--&gt;&gt;L: URL data\n        L-&gt;&gt;L: Validar expira\u00e7\u00e3o (expirou)\n        L--&gt;&gt;API: 410 Gone\n        API--&gt;&gt;C: 410 Gone\n    else URL n\u00e3o encontrada\n        S3--&gt;&gt;L: NoSuchKey Exception\n        L--&gt;&gt;API: 500 Error\n        API--&gt;&gt;C: 500 Error\n    end</code></pre>"},{"location":"api/redirect-url/#validacao-de-expiracao","title":"Valida\u00e7\u00e3o de Expira\u00e7\u00e3o","text":"<p>O servi\u00e7o verifica automaticamente se a URL ainda est\u00e1 v\u00e1lida comparando:</p> <pre><code>long currentTimeInSeconds = System.currentTimeMillis() / 1000;\nif (urlData.getExpirationTime() &lt; currentTimeInSeconds) {\n    // URL expirou -&gt; retorna 410 Gone\n}\n</code></pre> <p>Timestamp Unix</p> <p>O tempo de expira\u00e7\u00e3o \u00e9 armazenado como timestamp Unix (segundos desde 01/01/1970).</p>"},{"location":"api/redirect-url/#exemplos-praticos","title":"Exemplos Pr\u00e1ticos","text":""},{"location":"api/redirect-url/#teste-de-url-valida","title":"Teste de URL V\u00e1lida","text":"<pre><code># 1. Criar uma URL (v\u00e1lida por 1 hora)\ncurl -X POST https://api.exemplo.com/create \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"originalUrl\": \"https://github.com/seu-usuario/projeto\",\n    \"expirationTime\": \"'$(($(date +%s) + 3600))'\"\n  }'\n\n# Resposta: {\"code\": \"a1b2c3d4\"}\n\n# 2. Testar redirecionamento\ncurl -I https://api.exemplo.com/a1b2c3d4\n\n# Resposta esperada:\n# HTTP/1.1 302 Found\n# Location: https://github.com/seu-usuario/projeto\n</code></pre>"},{"location":"api/redirect-url/#teste-de-url-expirada","title":"Teste de URL Expirada","text":"<pre><code># Testar com c\u00f3digo de URL expirada\ncurl -I https://api.exemplo.com/expired123\n\n# Resposta esperada:\n# HTTP/1.1 410 Gone\n# This URL has expired.\n</code></pre>"},{"location":"api/redirect-url/#teste-de-codigo-invalido","title":"Teste de C\u00f3digo Inv\u00e1lido","text":"<pre><code># Testar com c\u00f3digo inexistente\ncurl -I https://api.exemplo.com/invalid0\n\n# Resposta esperada:\n# HTTP/1.1 500 Internal Server Error\n</code></pre>"},{"location":"api/redirect-url/#monitoramento","title":"Monitoramento","text":""},{"location":"api/redirect-url/#metricas-importantes","title":"M\u00e9tricas Importantes","text":"<ul> <li>Taxa de sucesso: Porcentagem de redirects 302</li> <li>URLs expiradas: Quantidade de respostas 410</li> <li>C\u00f3digos inv\u00e1lidos: Quantidade de erros 500</li> <li>Tempo de resposta: Lat\u00eancia m\u00e9dia do servi\u00e7o</li> </ul>"},{"location":"api/redirect-url/#logs-tipicos","title":"Logs T\u00edpicos","text":"<pre><code>{\n  \"timestamp\": \"2025-06-04T10:30:00.000Z\",\n  \"requestId\": \"a1b2c3d4-e5f6-7890-1234-567890abcdef\",\n  \"shortCode\": \"a1b2c3d4\",\n  \"status\": \"success\",\n  \"statusCode\": 302,\n  \"originalUrl\": \"https://exemplo.com/artigo\",\n  \"responseTime\": 45\n}\n</code></pre>"},{"location":"api/redirect-url/#performance","title":"Performance","text":""},{"location":"api/redirect-url/#otimizacoes-implementadas","title":"Otimiza\u00e7\u00f5es Implementadas","text":"<ul> <li>Cold Start: Minimizado com inicializa\u00e7\u00e3o do S3Client</li> <li>Memory: Lambda configurado com 512MB para performance otimizada</li> <li>Timeout: 30 segundos para opera\u00e7\u00f5es S3</li> <li>Retry: Configura\u00e7\u00e3o autom\u00e1tica do AWS SDK</li> </ul>"},{"location":"api/redirect-url/#benchmarks-tipicos","title":"Benchmarks T\u00edpicos","text":"M\u00e9trica Valor M\u00e9dio Cold Start ~200ms Warm Request ~50ms S3 Fetch ~20ms Total Response Time ~70ms"},{"location":"api/redirect-url/#integracao","title":"Integra\u00e7\u00e3o","text":"<p>Este servi\u00e7o trabalha em conjunto com o Create URL Service:</p> <ol> <li>Create Service gera o c\u00f3digo e armazena no S3</li> <li>Redirect Service resolve o c\u00f3digo e faz o redirecionamento</li> </ol> <p>Para mais detalhes sobre a arquitetura completa, consulte System Overview.</p>"},{"location":"api/redirect-url/#troubleshooting","title":"Troubleshooting","text":""},{"location":"api/redirect-url/#problemas-comuns","title":"Problemas Comuns","text":"URL n\u00e3o redireciona <p>Poss\u00edveis causas:</p> <ul> <li>C\u00f3digo n\u00e3o existe no sistema</li> <li>URL expirou</li> <li>Problemas de conectividade com S3</li> </ul> <p>Solu\u00e7\u00e3o:</p> <ol> <li>Verificar se o c\u00f3digo existe: <code>aws s3 ls s3://aws-url-shortner-app/</code></li> <li>Verificar logs do Lambda no CloudWatch</li> <li>Testar conectividade com S3</li> </ol> Erro 500 frequente <p>Poss\u00edveis causas:</p> <ul> <li>Permiss\u00f5es IAM insuficientes</li> <li>Bucket S3 n\u00e3o existe</li> <li>Timeout na opera\u00e7\u00e3o S3</li> </ul> <p>Solu\u00e7\u00e3o:</p> <ol> <li>Verificar permiss\u00f5es IAM para <code>s3:GetObject</code></li> <li>Confirmar exist\u00eancia do bucket</li> <li>Aumentar timeout do Lambda se necess\u00e1rio</li> </ol> <p>Para mais detalhes, consulte Troubleshooting Guide.</p>"},{"location":"deployment/aws-setup/","title":"AWS Setup Guide","text":"<p>Este guia detalha como configurar e fazer deploy do URL Shortener System na AWS, incluindo todos os recursos necess\u00e1rios.</p>"},{"location":"deployment/aws-setup/#pre-requisitos","title":"Pr\u00e9-requisitos","text":"<p>Antes de come\u00e7ar, certifique-se de ter:</p> <ul> <li> Conta AWS ativa</li> <li> AWS CLI instalado e configurado</li> <li> Java 17+ instalado</li> <li> Maven 3.6+ instalado</li> <li> Conhecimentos b\u00e1sicos de AWS Lambda e S3</li> </ul>"},{"location":"deployment/aws-setup/#recursos-aws-necessarios","title":"Recursos AWS Necess\u00e1rios","text":"Servi\u00e7o Finalidade Estimativa de Custo S3 Bucket Armazenamento de URLs ~$0.01/m\u00eas Lambda (2 fun\u00e7\u00f5es) Processamento Free tier at\u00e9 1M requests API Gateway Roteamento HTTP Free tier at\u00e9 1M requests CloudWatch Logs e monitoramento ~$0.50/m\u00eas <p>Free Tier</p> <p>Para desenvolvimento e portf\u00f3lio, o uso ficar\u00e1 dentro do Free Tier da AWS na maioria dos casos.</p>"},{"location":"deployment/aws-setup/#1-configuracao-do-aws-cli","title":"1. Configura\u00e7\u00e3o do AWS CLI","text":""},{"location":"deployment/aws-setup/#verificar-instalacao","title":"Verificar instala\u00e7\u00e3o","text":"<pre><code>aws --version\n# aws-cli/2.x.x Python/3.x.x\n</code></pre>"},{"location":"deployment/aws-setup/#configurar-credenciais","title":"Configurar credenciais","text":"<pre><code>aws configure\n# AWS Access Key ID: [sua-access-key]\n# AWS Secret Access Key: [sua-secret-key]\n# Default region name: us-east-1\n# Default output format: json\n</code></pre>"},{"location":"deployment/aws-setup/#testar-conectividade","title":"Testar conectividade","text":"<pre><code>aws sts get-caller-identity\n</code></pre>"},{"location":"deployment/aws-setup/#2-criacao-do-s3-bucket","title":"2. Cria\u00e7\u00e3o do S3 Bucket","text":""},{"location":"deployment/aws-setup/#21-criar-bucket-via-cli","title":"2.1 Criar bucket via CLI","text":"<pre><code># Substitua por um nome \u00fanico\nBUCKET_NAME=\"aws-url-shortner-app-$(date +%s)\"\n\n# Criar bucket\naws s3 mb s3://$BUCKET_NAME --region us-east-1\n\n# Verificar cria\u00e7\u00e3o\naws s3 ls | grep $BUCKET_NAME\n</code></pre>"},{"location":"deployment/aws-setup/#22-configurar-politica-do-bucket","title":"2.2 Configurar pol\u00edtica do bucket","text":"<pre><code># Criar arquivo de pol\u00edtica\ncat &gt; bucket-policy.json &lt;&lt; 'EOF'\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"LambdaAccessOnly\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"Service\": \"lambda.amazonaws.com\"\n            },\n            \"Action\": [\n                \"s3:GetObject\",\n                \"s3:PutObject\"\n            ],\n            \"Resource\": \"arn:aws:s3:::BUCKET_NAME/*\"\n        }\n    ]\n}\nEOF\n\n# Substituir nome do bucket na pol\u00edtica\nsed -i \"s/BUCKET_NAME/$BUCKET_NAME/g\" bucket-policy.json\n\n# Aplicar pol\u00edtica\naws s3api put-bucket-policy --bucket $BUCKET_NAME --policy file://bucket-policy.json\n</code></pre> <p>Nome do Bucket</p> <p>Lembre-se de atualizar o nome do bucket (<code>aws-url-shortner-app</code>) no c\u00f3digo das Lambdas para o nome gerado.</p>"},{"location":"deployment/aws-setup/#3-build-dos-projetos","title":"3. Build dos Projetos","text":""},{"location":"deployment/aws-setup/#31-build-do-create-url-service","title":"3.1 Build do Create URL Service","text":"<pre><code>cd create-url-service\nmvn clean package\n\n# Verificar se o JAR foi gerado\nls -la target/CreateUrlLambda-1.0-SNAPSHOT.jar\n</code></pre>"},{"location":"deployment/aws-setup/#32-build-do-redirect-service","title":"3.2 Build do Redirect Service","text":"<pre><code>cd ../redirect-url-service\nmvn clean package\n\n# Verificar se o JAR foi gerado\nls -la target/RedirectUrlShortner-1.0-SNAPSHOT.jar\n</code></pre>"},{"location":"deployment/aws-setup/#4-criacao-das-iam-roles","title":"4. Cria\u00e7\u00e3o das IAM Roles","text":""},{"location":"deployment/aws-setup/#41-role-para-create-url-lambda","title":"4.1 Role para Create URL Lambda","text":"<pre><code># Criar assume role policy\ncat &gt; lambda-assume-role-policy.json &lt;&lt; 'EOF'\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"Service\": \"lambda.amazonaws.com\"\n            },\n            \"Action\": \"sts:AssumeRole\"\n        }\n    ]\n}\nEOF\n\n# Criar role\naws iam create-role \\\n    --role-name URLShortenerLambdaRole \\\n    --assume-role-policy-document file://lambda-assume-role-policy.json\n\n# Anexar pol\u00edtica b\u00e1sica do Lambda\naws iam attach-role-policy \\\n    --role-name URLShortenerLambdaRole \\\n    --policy-arn arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\n</code></pre>"},{"location":"deployment/aws-setup/#42-politica-personalizada-para-s3","title":"4.2 Pol\u00edtica personalizada para S3","text":"<pre><code># Criar pol\u00edtica S3\ncat &gt; s3-access-policy.json &lt;&lt; 'EOF'\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"s3:GetObject\",\n                \"s3:PutObject\"\n            ],\n            \"Resource\": \"arn:aws:s3:::BUCKET_NAME/*\"\n        }\n    ]\n}\nEOF\n\n# Substituir nome do bucket\nsed -i \"s/BUCKET_NAME/$BUCKET_NAME/g\" s3-access-policy.json\n\n# Criar e anexar pol\u00edtica\naws iam create-policy \\\n    --policy-name URLShortenerS3Policy \\\n    --policy-document file://s3-access-policy.json\n\n# Obter ARN da conta\nACCOUNT_ID=$(aws sts get-caller-identity --query Account --output text)\n\n# Anexar \u00e0 role\naws iam attach-role-policy \\\n    --role-name URLShortenerLambdaRole \\\n    --policy-arn arn:aws:iam::$ACCOUNT_ID:policy/URLShortenerS3Policy\n</code></pre>"},{"location":"deployment/aws-setup/#5-deploy-das-lambda-functions","title":"5. Deploy das Lambda Functions","text":""},{"location":"deployment/aws-setup/#51-deploy-create-url-lambda","title":"5.1 Deploy Create URL Lambda","text":"<pre><code># Obter ARN da role\nROLE_ARN=$(aws iam get-role --role-name URLShortenerLambdaRole --query 'Role.Arn' --output text)\n\n# Criar fun\u00e7\u00e3o Lambda\naws lambda create-function \\\n    --function-name CreateUrlShortener \\\n    --runtime java17 \\\n    --role $ROLE_ARN \\\n    --handler com.rocketseat.createUrlShortner.Main::handleRequest \\\n    --zip-file fileb://create-url-service/target/CreateUrlLambda-1.0-SNAPSHOT.jar \\\n    --timeout 30 \\\n    --memory-size 512 \\\n    --environment Variables='{BUCKET_NAME='$BUCKET_NAME'}'\n</code></pre>"},{"location":"deployment/aws-setup/#52-deploy-redirect-lambda","title":"5.2 Deploy Redirect Lambda","text":"<pre><code># Criar fun\u00e7\u00e3o Lambda\naws lambda create-function \\\n    --function-name RedirectUrlShortener \\\n    --runtime java17 \\\n    --role $ROLE_ARN \\\n    --handler com.rocketseat.redirectUrlShortner.Main::handleRequest \\\n    --zip-file fileb://redirect-url-service/target/RedirectUrlShortner-1.0-SNAPSHOT.jar \\\n    --timeout 30 \\\n    --memory-size 512 \\\n    --environment Variables='{BUCKET_NAME='$BUCKET_NAME'}'\n</code></pre>"},{"location":"deployment/aws-setup/#53-testar-as-funcoes","title":"5.3 Testar as fun\u00e7\u00f5es","text":"<pre><code># Teste b\u00e1sico da Create URL\naws lambda invoke \\\n    --function-name CreateUrlShortener \\\n    --payload '{\"body\": \"{\\\"originalUrl\\\":\\\"https://example.com\\\",\\\"expirationTime\\\":\\\"999999999999\\\"}\"}' \\\n    response.json\n\ncat response.json\n\n# Teste b\u00e1sico da Redirect (usar c\u00f3digo retornado)\naws lambda invoke \\\n    --function-name RedirectUrlShortener \\\n    --payload '{\"rawPath\": \"/CODIGO_RETORNADO\"}' \\\n    redirect-response.json\n\ncat redirect-response.json\n</code></pre>"},{"location":"deployment/aws-setup/#6-configuracao-do-api-gateway","title":"6. Configura\u00e7\u00e3o do API Gateway","text":""},{"location":"deployment/aws-setup/#61-criar-api-rest","title":"6.1 Criar API REST","text":"<pre><code># Criar API\nAPI_ID=$(aws apigateway create-rest-api \\\n    --name URLShortenerAPI \\\n    --description \"API for URL Shortener System\" \\\n    --query 'id' --output text)\n\necho \"API ID: $API_ID\"\n\n# Obter Root Resource ID\nROOT_RESOURCE_ID=$(aws apigateway get-resources \\\n    --rest-api-id $API_ID \\\n    --query 'items[0].id' --output text)\n</code></pre>"},{"location":"deployment/aws-setup/#62-configurar-rota-para-criacao-create","title":"6.2 Configurar rota para cria\u00e7\u00e3o (/create)","text":"<pre><code># Criar resource /create\nCREATE_RESOURCE_ID=$(aws apigateway create-resource \\\n    --rest-api-id $API_ID \\\n    --parent-id $ROOT_RESOURCE_ID \\\n    --path-part create \\\n    --query 'id' --output text)\n\n# Criar m\u00e9todo POST\naws apigateway put-method \\\n    --rest-api-id $API_ID \\\n    --resource-id $CREATE_RESOURCE_ID \\\n    --http-method POST \\\n    --authorization-type NONE\n\n# Integrar com Lambda\nACCOUNT_ID=$(aws sts get-caller-identity --query Account --output text)\n\naws apigateway put-integration \\\n    --rest-api-id $API_ID \\\n    --resource-id $CREATE_RESOURCE_ID \\\n    --http-method POST \\\n    --type AWS_PROXY \\\n    --integration-http-method POST \\\n    --uri arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:$ACCOUNT_ID:function:CreateUrlShortener/invocations\n\n# Dar permiss\u00e3o ao API Gateway\naws lambda add-permission \\\n    --function-name CreateUrlShortener \\\n    --statement-id apigateway-invoke \\\n    --action lambda:InvokeFunction \\\n    --principal apigateway.amazonaws.com \\\n    --source-arn \"arn:aws:execute-api:us-east-1:$ACCOUNT_ID:$API_ID/*/POST/create\"\n</code></pre>"},{"location":"deployment/aws-setup/#63-configurar-rota-para-redirecionamento-code","title":"6.3 Configurar rota para redirecionamento (/{code})","text":"<pre><code># Criar resource {code}\nREDIRECT_RESOURCE_ID=$(aws apigateway create-resource \\\n    --rest-api-id $API_ID \\\n    --parent-id $ROOT_RESOURCE_ID \\\n    --path-part '{code}' \\\n    --query 'id' --output text)\n\n# Criar m\u00e9todo GET\naws apigateway put-method \\\n    --rest-api-id $API_ID \\\n    --resource-id $REDIRECT_RESOURCE_ID \\\n    --http-method GET \\\n    --authorization-type NONE\n\n# Integrar com Lambda\naws apigateway put-integration \\\n    --rest-api-id $API_ID \\\n    --resource-id $REDIRECT_RESOURCE_ID \\\n    --http-method GET \\\n    --type AWS_PROXY \\\n    --integration-http-method POST \\\n    --uri arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:$ACCOUNT_ID:function:RedirectUrlShortener/invocations\n\n# Dar permiss\u00e3o ao API Gateway\naws lambda add-permission \\\n    --function-name RedirectUrlShortener \\\n    --statement-id apigateway-invoke \\\n    --action lambda:InvokeFunction \\\n    --principal apigateway.amazonaws.com \\\n    --source-arn \"arn:aws:execute-api:us-east-1:$ACCOUNT_ID:$API_ID/*/GET/*\"\n</code></pre>"},{"location":"deployment/aws-setup/#64-deploy-da-api","title":"6.4 Deploy da API","text":"<pre><code># Criar deployment\naws apigateway create-deployment \\\n    --rest-api-id $API_ID \\\n    --stage-name prod\n\n# Obter URL da API\nAPI_URL=\"https://$API_ID.execute-api.us-east-1.amazonaws.com/prod\"\necho \"API URL: $API_URL\"\n</code></pre>"},{"location":"deployment/aws-setup/#7-teste-da-api-completa","title":"7. Teste da API Completa","text":""},{"location":"deployment/aws-setup/#71-testar-criacao-de-url","title":"7.1 Testar cria\u00e7\u00e3o de URL","text":"<pre><code># Criar URL encurtada\ncurl -X POST $API_URL/create \\\n    -H \"Content-Type: application/json\" \\\n    -d '{\n        \"originalUrl\": \"https://github.com/seu-usuario/url-shortener-system\",\n        \"expirationTime\": \"999999999999\"\n    }'\n\n# Resposta esperada: {\"code\":\"a1b2c3d4\"}\n</code></pre>"},{"location":"deployment/aws-setup/#72-testar-redirecionamento","title":"7.2 Testar redirecionamento","text":"<pre><code># Testar redirecionamento (substitua pelo c\u00f3digo retornado)\ncurl -I $API_URL/a1b2c3d4\n\n# Resposta esperada: HTTP/1.1 302 Found\n#                   Location: https://github.com/seu-usuario/url-shortener-system\n</code></pre>"},{"location":"deployment/aws-setup/#8-configuracao-de-monitoramento","title":"8. Configura\u00e7\u00e3o de Monitoramento","text":""},{"location":"deployment/aws-setup/#81-habilitar-logs-detalhados","title":"8.1 Habilitar logs detalhados","text":"<pre><code># Criar role para API Gateway logs\ncat &gt; apigateway-logs-role.json &lt;&lt; 'EOF'\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"Service\": \"apigateway.amazonaws.com\"\n            },\n            \"Action\": \"sts:AssumeRole\"\n        }\n    ]\n}\nEOF\n\naws iam create-role \\\n    --role-name APIGatewayLogsRole \\\n    --assume-role-policy-document file://apigateway-logs-role.json\n\naws iam attach-role-policy \\\n    --role-name APIGatewayLogsRole \\\n    --policy-arn arn:aws:iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs\n</code></pre>"},{"location":"deployment/aws-setup/#82-configurar-cloudwatch","title":"8.2 Configurar CloudWatch","text":"<pre><code># Obter ARN da role de logs\nLOGS_ROLE_ARN=$(aws iam get-role --role-name APIGatewayLogsRole --query 'Role.Arn' --output text)\n\n# Configurar logs no API Gateway\naws apigateway update-account \\\n    --patch-ops op=replace,path=/cloudwatchRoleArn,value=$LOGS_ROLE_ARN\n</code></pre>"},{"location":"deployment/aws-setup/#9-limpeza-de-recursos-opcional","title":"9. Limpeza de Recursos (Opcional)","text":"<p>Para remover todos os recursos criados:</p> <pre><code># Deletar API Gateway\naws apigateway delete-rest-api --rest-api-id $API_ID\n\n# Deletar Lambda functions\naws lambda delete-function --function-name CreateUrlShortener\naws lambda delete-function --function-name RedirectUrlShortener\n\n# Deletar S3 bucket (deve estar vazio)\naws s3 rm s3://$BUCKET_NAME --recursive\naws s3 rb s3://$BUCKET_NAME\n\n# Deletar IAM roles e pol\u00edticas\naws iam detach-role-policy --role-name URLShortenerLambdaRole --policy-arn arn:aws:iam::$ACCOUNT_ID:policy/URLShortenerS3Policy\naws iam delete-policy --policy-arn arn:aws:iam::$ACCOUNT_ID:policy/URLShortenerS3Policy\naws iam detach-role-policy --role-name URLShortenerLambdaRole --policy-arn arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\naws iam delete-role --role-name URLShortenerLambdaRole\n</code></pre>"},{"location":"deployment/aws-setup/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<p>Ap\u00f3s completar o setup:</p> <ol> <li>Configurar permiss\u00f5es IAM detalhadas</li> <li>Implementar monitoramento</li> </ol>"},{"location":"deployment/aws-setup/#troubleshooting","title":"Troubleshooting","text":"<p>Problemas comuns e solu\u00e7\u00f5es:</p> <p>Lambda timeout</p> <p>Aumente o timeout das fun\u00e7\u00f5es Lambda se necess\u00e1rio: <pre><code>aws lambda update-function-configuration \\\n    --function-name CreateUrlShortener \\\n    --timeout 60\n</code></pre></p> <p>Permiss\u00f5es S3</p> <p>Verifique se o nome do bucket no c\u00f3digo corresponde ao criado.</p> <p>CORS Issues</p> <p>Configure CORS no API Gateway se necess\u00e1rio para chamadas do browser.</p> <p>Estimativa de tempo: 30-45 minutos para setup completo Custo estimado: &lt;$1/m\u00eas para uso de desenvolvimento</p>"},{"location":"deployment/iam-permissions/","title":"IAM Permissions","text":"<p>Este documento detalha todas as permiss\u00f5es IAM necess\u00e1rias para o funcionamento completo do URL Shortener System na AWS.</p>"},{"location":"deployment/iam-permissions/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O sistema requer permiss\u00f5es espec\u00edficas para cada Lambda function acessar o Amazon S3 e outros servi\u00e7os AWS necess\u00e1rios.</p> <p>Princ\u00edpio do Menor Privil\u00e9gio</p> <p>Todas as permiss\u00f5es seguem o princ\u00edpio do menor privil\u00e9gio, concedendo apenas os acessos m\u00ednimos necess\u00e1rios para o funcionamento.</p>"},{"location":"deployment/iam-permissions/#permissoes-por-servico","title":"Permiss\u00f5es por Servi\u00e7o","text":""},{"location":"deployment/iam-permissions/#create-url-lambda","title":"Create URL Lambda","text":"<p>A fun\u00e7\u00e3o de cria\u00e7\u00e3o de URLs precisa de permiss\u00f5es para escrever objetos no S3.</p> create-url-lambda-policy.json<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"S3PutObjectPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:PutObject\",\n        \"s3:PutObjectAcl\"\n      ],\n      \"Resource\": \"arn:aws:s3:::aws-url-shortner-app/*\"\n    },\n    {\n      \"Sid\": \"CloudWatchLogsPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:*\"\n    }\n  ]\n}\n</code></pre>"},{"location":"deployment/iam-permissions/#redirect-url-lambda","title":"Redirect URL Lambda","text":"<p>A fun\u00e7\u00e3o de redirecionamento precisa de permiss\u00f5es para ler objetos do S3.</p> redirect-url-lambda-policy.json<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"S3GetObjectPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\"\n      ],\n      \"Resource\": \"arn:aws:s3:::aws-url-shortner-app/*\"\n    },\n    {\n      \"Sid\": \"CloudWatchLogsPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:*\"\n    }\n  ]\n}\n</code></pre>"},{"location":"deployment/iam-permissions/#roles-iam","title":"Roles IAM","text":""},{"location":"deployment/iam-permissions/#create-url-lambda-role","title":"Create URL Lambda Role","text":"create-url-lambda-role.json<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n</code></pre>"},{"location":"deployment/iam-permissions/#redirect-url-lambda-role","title":"Redirect URL Lambda Role","text":"redirect-url-lambda-role.json<pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n</code></pre>"},{"location":"deployment/iam-permissions/#configuracao-via-aws-cli","title":"Configura\u00e7\u00e3o via AWS CLI","text":""},{"location":"deployment/iam-permissions/#1-configurar-role-para-create-url-lambda","title":"1. Configurar Role para Create URL Lambda","text":"Criar RoleAnexar Policy <pre><code># Criar role\naws iam create-role \\\n  --role-name CreateUrlLambdaRole \\\n  --assume-role-policy-document file://create-url-lambda-role.json\n</code></pre> <pre><code># Criar policy\naws iam create-policy \\\n  --policy-name CreateUrlLambdaPolicy \\\n  --policy-document file://create-url-lambda-policy.json\n\n# Anexar policy ao role\naws iam attach-role-policy \\\n  --role-name CreateUrlLambdaRole \\\n  --policy-arn arn:aws:iam::ACCOUNT-ID:policy/CreateUrlLambdaPolicy\n</code></pre>"},{"location":"deployment/iam-permissions/#2-configurar-role-para-redirect-url-lambda","title":"2. Configurar Role para Redirect URL Lambda","text":"Criar RoleAnexar Policy <pre><code># Criar role\naws iam create-role \\\n  --role-name RedirectUrlLambdaRole \\\n  --assume-role-policy-document file://redirect-url-lambda-role.json\n</code></pre> <pre><code># Criar policy\naws iam create-policy \\\n  --policy-name RedirectUrlLambdaPolicy \\\n  --policy-document file://redirect-url-lambda-policy.json\n\n# Anexar policy ao role\naws iam attach-role-policy \\\n  --role-name RedirectUrlLambdaRole \\\n  --policy-arn arn:aws:iam::ACCOUNT-ID:policy/RedirectUrlLambdaPolicy\n</code></pre>"},{"location":"deployment/iam-permissions/#configuracao-via-console-aws","title":"Configura\u00e7\u00e3o via Console AWS","text":""},{"location":"deployment/iam-permissions/#passo-1-criar-roles","title":"Passo 1: Criar Roles","text":"<ol> <li>Navegue para IAM \u2192 Roles \u2192 Create role</li> <li>Selecione AWS service \u2192 Lambda</li> <li>Nomeie o role: <code>CreateUrlLambdaRole</code> ou <code>RedirectUrlLambdaRole</code></li> </ol>"},{"location":"deployment/iam-permissions/#passo-2-criar-policies","title":"Passo 2: Criar Policies","text":"<ol> <li>Navegue para IAM \u2192 Policies \u2192 Create policy</li> <li>Selecione JSON e cole o conte\u00fado da policy</li> <li>Nomeie adequadamente: <code>CreateUrlLambdaPolicy</code> ou <code>RedirectUrlLambdaPolicy</code></li> </ol>"},{"location":"deployment/iam-permissions/#passo-3-anexar-policies-aos-roles","title":"Passo 3: Anexar Policies aos Roles","text":"<ol> <li>Navegue para IAM \u2192 Roles \u2192 Selecione o role</li> <li>Attach policies \u2192 Selecione a policy correspondente</li> <li>Attach policy</li> </ol>"},{"location":"deployment/iam-permissions/#verificacao-de-permissoes","title":"Verifica\u00e7\u00e3o de Permiss\u00f5es","text":""},{"location":"deployment/iam-permissions/#testar-permissoes-create-url","title":"Testar Permiss\u00f5es Create URL","text":"<pre><code># Testar se pode criar objeto no S3\naws s3 cp test-file.txt s3://aws-url-shortner-app/test-file.txt \\\n  --profile create-url-lambda\n</code></pre>"},{"location":"deployment/iam-permissions/#testar-permissoes-redirect-url","title":"Testar Permiss\u00f5es Redirect URL","text":"<pre><code># Testar se pode ler objeto do S3\naws s3 cp s3://aws-url-shortner-app/test-file.txt ./downloaded-file.txt \\\n  --profile redirect-url-lambda\n</code></pre>"},{"location":"deployment/iam-permissions/#matriz-de-permissoes","title":"Matriz de Permiss\u00f5es","text":"Servi\u00e7o Create URL Lambda Redirect URL Lambda S3 - GetObject \u274c \u2705 S3 - PutObject \u2705 \u274c S3 - PutObjectAcl \u2705 \u274c CloudWatch Logs \u2705 \u2705"},{"location":"deployment/iam-permissions/#troubleshooting","title":"Troubleshooting","text":""},{"location":"deployment/iam-permissions/#erro-accessdenied-no-s3","title":"Erro: AccessDenied no S3","text":"<pre><code># Verificar permiss\u00f5es do role\naws iam list-attached-role-policies --role-name CreateUrlLambdaRole\n\n# Verificar conte\u00fado da policy\naws iam get-policy-version \\\n  --policy-arn arn:aws:iam::ACCOUNT-ID:policy/CreateUrlLambdaPolicy \\\n  --version-id v1\n</code></pre>"},{"location":"deployment/iam-permissions/#erro-lambda-nao-consegue-escrever-logs","title":"Erro: Lambda n\u00e3o consegue escrever logs","text":"<pre><code># Verificar se CloudWatch Logs est\u00e1 na policy\naws iam simulate-principal-policy \\\n  --policy-source-arn arn:aws:iam::ACCOUNT-ID:role/CreateUrlLambdaRole \\\n  --action-names logs:CreateLogGroup logs:CreateLogStream logs:PutLogEvents \\\n  --resource-arns arn:aws:logs:us-east-1:ACCOUNT-ID:*\n</code></pre>"},{"location":"deployment/iam-permissions/#melhores-praticas-de-seguranca","title":"Melhores Pr\u00e1ticas de Seguran\u00e7a","text":""},{"location":"deployment/iam-permissions/#1-separacao-de-responsabilidades","title":"1. Separa\u00e7\u00e3o de Responsabilidades","text":"<ul> <li>Create Lambda: Apenas <code>PutObject</code></li> <li>Redirect Lambda: Apenas <code>GetObject</code></li> </ul>"},{"location":"deployment/iam-permissions/#2-especificidade-de-recursos","title":"2. Especificidade de Recursos","text":"<pre><code>{\n  \"Resource\": \"arn:aws:s3:::aws-url-shortner-app/*\"\n}\n</code></pre> <p>Espec\u00edfico vs Gen\u00e9rico</p> <p>Use <code>aws-url-shortner-app/*</code> em vez de <code>*</code> para limitar acesso apenas ao bucket necess\u00e1rio.</p>"},{"location":"deployment/iam-permissions/#3-monitoramento-de-acesso","title":"3. Monitoramento de Acesso","text":"<pre><code>{\n  \"Sid\": \"CloudTrailLogging\",\n  \"Effect\": \"Allow\",\n  \"Action\": [\n    \"cloudtrail:PutEvents\"\n  ],\n  \"Resource\": \"*\"\n}\n</code></pre>"},{"location":"deployment/iam-permissions/#rotacao-de-credenciais","title":"Rota\u00e7\u00e3o de Credenciais","text":"<p>Para ambientes de produ\u00e7\u00e3o, considere implementar:</p> <ol> <li>Rota\u00e7\u00e3o autom\u00e1tica de access keys</li> <li>Temporary credentials via STS</li> <li>Cross-account roles para isolamento</li> </ol>"},{"location":"deployment/iam-permissions/#checklist-de-configuracao","title":"Checklist de Configura\u00e7\u00e3o","text":"<ul> <li> Roles IAM criados para ambas as Lambdas</li> <li> Policies com permiss\u00f5es m\u00ednimas necess\u00e1rias</li> <li> Policies anexadas aos roles corretos</li> <li> CloudWatch Logs habilitado</li> <li> Bucket S3 criado com nome correto</li> <li> Permiss\u00f5es testadas e validadas</li> <li> Logs de acesso configurados (opcional)</li> </ul> <p>Configura\u00e7\u00e3o Completa</p> <p>Com essas permiss\u00f5es configuradas, o sistema estar\u00e1 pronto para funcionar de forma segura e eficiente na AWS.</p> <p>Pr\u00f3ximo passo: Configure o AWS Setup para deploy completo do sistema.</p>"}]}